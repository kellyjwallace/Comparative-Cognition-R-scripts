---
title: "Comparative cognition- comparison of all hand scorers wendy 9-1"
author: "Kelly Wallace"
date: "September 5, 2018"
output: html_document
---


#There are 12 hand scorers: Amogh Kashyap, Adam Redmer, Ben Whelan, Caleb Fleischer, Claire Mayorga, Daniel Hauser, Eduardo Saucedo, Huynh Pham, Jessika McFarland, Lauren Borland, Presley Mackey, Rahi Dakwala, and VIshaal Sakthivelnathan. Every student except Rahi scored Wendy 9_1, so here's the script that is comparing all the hand scores to see how far off they are from each other.


```{r, echo=FALSE, message=FALSE}
#Step 1a. load relevant packages

library(ggplot2)
library(dplyr)
library(rmarkdown)
library(knitr)
library(readr)
library(utils)

```





```{r, echo=FALSE, message=FALSE}
#Step 1b. list the file's you're going to analyze

file_list <- list.files("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/WENDY 9_1 for scorer comparisons- excludes Rahi", pattern = "*.csv")

```


```{r, echo=FALSE, message=FALSE}
#Step 1c. make an empty dataframe that you'll fill with data

test_column <- vector(length = length(file_list))

df <- data.frame(total = test_column)

```


```{r, echo=FALSE, message=FALSE}
#2a. Get data about proportion time spent in each zone

for(i in 1:length(file_list)){
  setwd("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/WENDY 9_1 for scorer comparisons- excludes Rahi")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename<-strsplit(filename, ".csv")[[1]][1]
  filename 
  filename.experiment<-strsplit(filename, "_")[[1]][1]
  filename.experiment
  filename.assay<-strsplit(filename, "_")[[1]][2]
  filename.assay
  filename.scorername<-strsplit(filename, "_")[[1]][3]
  filename.scorername
  filename.fishname<-strsplit(filename, "_")[[1]][4]
  filename.fishname<-gsub(" ", "", filename.fishname)
  filename.fishname
  filename.day<-strsplit(filename, "_")[[1]][5]
  filename.day
  filename.trial<-strsplit(filename, "_")[[1]][6]
  filename.trial
  filename.rightstim<-strsplit(filename, "_")[[1]][7]
  filename.rightstim
  filename.leftstim<-strsplit(filename, "_")[[1]][8]
  filename.leftstim
  filename.correctside<-strsplit(filename, "_")[[1]][9]
  filename.correctside
  filename.ratio<-strsplit(filename, "_")[[1]][10]
  filename.ratio
  filename.sex<-strsplit(filename, "_")[[1]][11]
  filename.sex
  filename.stdlength<-strsplit(filename, "_")[[1]][12]
  filename.stdlength
  filename.round<-strsplit(filename, "_")[[1]][13]
  filename.round
  filename.schedule<-strsplit(filename, "_")[[1]][14]
  filename.schedule
  filename.order<-strsplit(filename, "_")[[1]][15]
  filename.order
  filename.scoredate<-strsplit(filename, "_")[[1]][16]
  filename.scoredate
  
  filename.vidID<-paste(filename.fishname, filename.assay, filename.day, filename.trial, collapse="")
  filename.vidID
  
  fil$code<-gsub(" ", "", fil$code)
  fil$code<-tolower(fil$code)
  
    
  change_index <- which(fil$time > 30)[1]-1
  fil$time[change_index]<- 30
  fil<-filter(fil, time >= 30)
  fil.entries<-nrow(fil)
  
  #change_index2<- which(fil$time >=50)[1]
  #fil$time[change_index2]<- 50
  
  #fil<-filter(fil, time <= 50)
  fil<-mutate(fil, time.difference = -(time -lead(time)))
  #fil$time.difference <- replace(fil$time.difference, c(1), (fil$time[2])) use only if you're starting at time = 0 seconds
  
  fil.end<-fil[fil$code == "end",]
  fil.center<-fil[fil$code == "center",]
  fil.leftscreen<-fil[fil$code == "leftscreen",]
  fil.rightscreen<-fil[fil$code == "rightscreen",]
  fil.topleftthigmo<-fil[fil$code == "topleftthigmo",]
  fil.toprightthigmo<-fil[fil$code == "toprightthigmo",]
  fil.bottomleftthigmo<-fil[fil$code == "bottomleftthigmo",]
  fil.bottomrightthigmo<-fil[fil$code == "bottomrightthigmo",]
  fil.topmirror<-fil[fil$code == "topmirror",]
  fil.bottommirror<-fil[fil$code == "bottommirror",]
  
  df$fishname[i]<-filename.fishname
  df$fishname<-tolower(df$fishname)
  df$sex[i]<- filename.sex
  df$stdlength[i]<-filename.stdlength
  df$round[i]<-filename.round
  df$schedule[i]<-filename.schedule
  df$order[i]<-filename.order
  df$scoredate[i]<-filename.scoredate
  df$ratio[i]<-filename.ratio
  df$scorername[i]<-filename.scorername
  df$assay[i]<-filename.assay
  df$day[i]<-filename.day
  df$trial[i]<-filename.trial
  df$vidID[i]<-filename.vidID
  df$correctside[i]<-filename.correctside
  df$entries_full_4_minutes[i]<-fil.entries -1
  df$total[i]<-(sum(fil.end$time) - 30)
  df$center_full_4_minutes[i]<-sum(fil.center$time.difference) / (sum(fil.end$time) - 30)
  df$unique_zones_entered[i]<-(length(unique(fil$code)) - 1) / 9
  df$entries_into_center_full_4_minutes[i]<-nrow(fil.center)
  
  df$leftscreen_full_4_minutes[i]<-sum(fil.leftscreen$time.difference) / (sum(fil.end$time) - 30)
  df$rightscreen_full_4_minutes[i]<-sum(fil.rightscreen$time.difference) / (sum(fil.end$time) - 30)
  
  df$leftscreen_full_4_minutes_absolute_seconds[i]<-sum(fil.leftscreen$time.difference) 
  df$rightscreen_full_4_minutes_absolute_seconds[i]<-sum(fil.rightscreen$time.difference)
  

  #df$topleftthigmo[i]<-sum(fil.topleftthigmo$time.difference) / 20
  #df$toprightthigmo[i]<-sum(fil.toprightthigmo$time.difference) / 20
  #df$bottomleftthigmo[i]<-sum(fil.bottomleftthigmo$time.difference) / 20
  #df$bottomrightthigmo[i]<-sum(fil.bottomrightthigmo$time.difference) / 20
  #df$topmirror[i]<-sum(fil.topmirror$time.difference) / 20
  #df$bottommirror[i]<-sum(fil.bottommirror$time.difference) / 20
  
  #df$center[is.na(df$center)] <- 0
  #df$leftscreen[is.na(df$lectscreen)] <- 0
  #df$rightscreen[is.na(df$rightscreen)] <- 0
  #df$topleftthigmo[is.na(df$topleftthigmo)] <- 0
  #df$toprightthigmo[is.na(df$toprightthigmo)] <- 0
  #df$bottomleftthigmo[is.na(df$bottomleftthigmo)] <- 0
  #df$bottomrightthigmo[is.na(df$bottomrightthigmo)] <- 0
  #df$topmirror[is.na(df$topmirror)] <- 0
  #df$bottomrightthigmo[is.na(df$bottomrightthigmo)] <- 0
  
  df$totalthigmo_full_4_minutes[i]<- (sum(fil.topleftthigmo$time.difference) + sum(fil.toprightthigmo$time.difference) + sum(fil.bottomleftthigmo$time.difference) + sum(fil.bottomrightthigmo$time.difference)) / (sum(fil.end$time) - 30)
  
  df$totalmirror_full_4_minutes[i]<- (sum(fil.topmirror$time.difference) + sum(fil.bottommirror$time.difference)) /(sum(fil.end$time) - 30)
  
  #df$totalleft[i]<- (sum(fil.leftscreen$time.difference) + sum(fil.topleftthigmo$time.difference) + sum(fil.bottomleftthigmo$time.difference))/20
  #df$totalright[i]<- (sum(fil.rightscreen$time.difference) + sum(fil.toprightthigmo$time.difference) + sum(fil.bottomrightthigmo$time.difference))/20
}

for(i in 1:length(file_list)){
  setwd("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/WENDY 9_1 for scorer comparisons- excludes Rahi")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename<-strsplit(filename, ".csv")[[1]][1]
  filename 
  filename.experiment<-strsplit(filename, "_")[[1]][1]
  filename.experiment
  filename.assay<-strsplit(filename, "_")[[1]][2]
  filename.assay
  filename.scorername<-strsplit(filename, "_")[[1]][3]
  filename.scorername
  filename.fishname<-strsplit(filename, "_")[[1]][4]
  filename.fishname<-gsub(" ", "", filename.fishname)
  filename.fishname
  filename.day<-strsplit(filename, "_")[[1]][5]
  filename.day
  filename.trial<-strsplit(filename, "_")[[1]][6]
  filename.trial
  filename.rightstim<-strsplit(filename, "_")[[1]][7]
  filename.rightstim
  filename.leftstim<-strsplit(filename, "_")[[1]][8]
  filename.leftstim
  filename.correctside<-strsplit(filename, "_")[[1]][9]
  filename.correctside
  filename.ratio<-strsplit(filename, "_")[[1]][10]
  filename.ratio
  filename.sex<-strsplit(filename, "_")[[1]][11]
  filename.sex
  filename.stdlength<-strsplit(filename, "_")[[1]][12]
  filename.stdlength
  filename.round<-strsplit(filename, "_")[[1]][13]
  filename.round
  filename.schedule<-strsplit(filename, "_")[[1]][14]
  filename.schedule
  filename.order<-strsplit(filename, "_")[[1]][15]
  filename.order
  filename.scoredate<-strsplit(filename, "_")[[1]][16]
  filename.scoredate
  
  
  filename.vidID<-paste(filename.fishname, filename.assay, filename.day, filename.trial, collapse="")
  filename.vidID
  
  fil$code<-gsub(" ", "", fil$code)
  fil$code<-tolower(fil$code)

    
  change_index <- which(fil$time > 30)[1]-1
  fil$time[change_index]<- 30
  fil<-filter(fil, time >= 30)
  
  change_index2<- which(fil$time >=50)[1]
  fil$time[change_index2]<- 50
  
  fil<-filter(fil, time <= 50)
  fil<-mutate(fil, time.difference = -(time -lead(time, default = 50)))
  fil.entries<-nrow(fil)

  fil.end<-fil[fil$code == "end",]
  fil.center<-fil[fil$code == "center",]
  fil.leftscreen<-fil[fil$code == "leftscreen",]
  fil.rightscreen<-fil[fil$code == "rightscreen",]
  fil.topleftthigmo<-fil[fil$code == "topleftthigmo",]
  fil.toprightthigmo<-fil[fil$code == "toprightthigmo",]
  fil.bottomleftthigmo<-fil[fil$code == "bottomleftthigmo",]
  fil.bottomrightthigmo<-fil[fil$code == "bottomrightthigmo",]
  fil.topmirror<-fil[fil$code == "topmirror",]
  fil.bottommirror<-fil[fil$code == "bottommirror",]

  df$leftscreen_T30_to_T50[i]<-sum(fil.leftscreen$time.difference) / 20
  df$rightscreen_T30_to_T50[i]<-sum(fil.rightscreen$time.difference) / 20
  df$entries_T30_to_T50[i]<-fil.entries -1
  
  df$leftscreen_T30_to_T50_absolute_seconds[i]<-sum(fil.leftscreen$time.difference) 
  df$rightscreen_T30_to_T50_absolute_seconds[i]<-sum(fil.rightscreen$time.difference)
}

for(i in 1:length(file_list)){
  setwd("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/WENDY 9_1 for scorer comparisons- excludes Rahi")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)
  filename <- file_list[i]
  filename<-strsplit(filename, ".csv")[[1]][1]
  filename 
  filename.experiment<-strsplit(filename, "_")[[1]][1]
  filename.experiment
  filename.assay<-strsplit(filename, "_")[[1]][2]
  filename.assay
  filename.scorername<-strsplit(filename, "_")[[1]][3]
  filename.scorername
  filename.fishname<-strsplit(filename, "_")[[1]][4]
  filename.fishname<-gsub(" ", "", filename.fishname)
  filename.fishname
  filename.day<-strsplit(filename, "_")[[1]][5]
  filename.day
  filename.trial<-strsplit(filename, "_")[[1]][6]
  filename.trial
  filename.rightstim<-strsplit(filename, "_")[[1]][7]
  filename.rightstim
  filename.leftstim<-strsplit(filename, "_")[[1]][8]
  filename.leftstim
  filename.correctside<-strsplit(filename, "_")[[1]][9]
  filename.correctside
  filename.ratio<-strsplit(filename, "_")[[1]][10]
  filename.ratio
  filename.sex<-strsplit(filename, "_")[[1]][11]
  filename.sex
  filename.stdlength<-strsplit(filename, "_")[[1]][12]
  filename.stdlength
  filename.round<-strsplit(filename, "_")[[1]][13]
  filename.round
  filename.schedule<-strsplit(filename, "_")[[1]][14]
  filename.schedule
  filename.order<-strsplit(filename, "_")[[1]][15]
  filename.order
  filename.scoredate<-strsplit(filename, "_")[[1]][16]
  filename.scoredate
  
  
  filename.vidID<-paste(filename.fishname, filename.assay, filename.day, filename.trial, collapse="")
  filename.vidID

  
  fil$code<-gsub(" ", "", fil$code)
  fil$code<-tolower(fil$code)
 
    
  change_index <- which(fil$time > 29)[1] 
  fil$time[change_index]<- 29
  fil<-filter(fil, time <= 29)
  fil.entries<-nrow(fil)

  fil<-mutate(fil, time.difference = -(time -lead(time, default = 29)))

  fil.end<-fil[fil$code == "end",]
  fil.center<-fil[fil$code == "center",]
  fil.leftscreen<-fil[fil$code == "leftscreen",]
  fil.rightscreen<-fil[fil$code == "rightscreen",]
  fil.topleftthigmo<-fil[fil$code == "topleftthigmo",]
  fil.toprightthigmo<-fil[fil$code == "toprightthigmo",]
  fil.bottomleftthigmo<-fil[fil$code == "bottomleftthigmo",]
  fil.bottomrightthigmo<-fil[fil$code == "bottomrightthigmo",]
  fil.topmirror<-fil[fil$code == "topmirror",]
  fil.bottommirror<-fil[fil$code == "bottommirror",]

df$prop_time_thigmo_T0_to_T29[i]<-(sum(fil.topleftthigmo$time.difference) + sum(fil.toprightthigmo$time.difference) + sum(fil.bottomleftthigmo$time.difference) + sum(fil.bottomrightthigmo$time.difference)) / 29
df$prop_time_mirror_T0_to_T29[i]<- (sum(fil.topmirror$time.difference) + sum(fil.bottommirror$time.difference)) / 29
df$entries_T0_to_T29[i]<-fil.entries -1  
}

```


```{r, echo=FALSE, message=FALSE}
#4a. Latency to react to screen (i.e. move to any zone after T30)


for(i in 1:length(file_list)){
  setwd("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/WENDY 9_1 for scorer comparisons- excludes Rahi")
  
  fil <- read_csv(file_list[i], col_names = TRUE, col_types = NULL)

  fil$code<-gsub(" ", "", fil$code)
  fil$code<-tolower(fil$code)

    
  change_index <- which(fil$time > 30)[1]-1
  fil$time[change_index]<- 30
  fil<-filter(fil, time >= 30)
  
  #change_index2<- which(fil$time >=50)[1]
  #fil$time[change_index2]<- 50
  
  #fil<-filter(fil, time <= 50)
  #fil<-mutate(fil, time.difference = -(time -lead(time, default = 50)))

   df$reaction_time[i]<- ((fil$time[2]) - 30)
}

```


```{r, echo=FALSE, message=FALSE}
#range for each category 

#entries full four minutes- ABSOLUTE NUMBER
max(df$entries_full_4_minutes) - min(df$entries_full_4_minutes) #18
shapiro.test(df$entries_full_4_minutes) #greater than 0.05, means it is normal, can calculate standard dev
sd(df$entries_full_4_minutes) #6.94 entries

#center full 4 minutes
max(df$center_full_4_minutes) - min(df$center_full_4_minutes) #3.4%
shapiro.test(df$center_full_4_minutes)
sd(df$center_full_4_minutes) #0.010 or std of 1%

#right screen full 4 minutes
max(df$rightscreen_full_4_minutes) - min(df$rightscreen_full_4_minutes) #2.0%
shapiro.test(df$rightscreen_full_4_minutes)
sd(df$rightscreen_full_4_minutes) #0.005 or std of 0.5%

#left screen full 4 minutes
max(df$leftscreen_full_4_minutes) - min(df$leftscreen_full_4_minutes)#2.1%
shapiro.test(df$leftscreen_full_4_minutes)
sd(df$leftscreen_full_4_minutes) #0.007 or std of 0.7%

#totlamirror full 4 minutes
max(df$totalmirror_full_4_minutes) - min(df$totalmirror_full_4_minutes) #4.6%
shapiro.test(df$totalmirror_full_4_minutes) 
sd(df$totalmirror_full_4_minutes) #0.013 or std of 1.3%

#total thigmo full 4 minutes
max(df$totalthigmo_full_4_minutes) - min(df$totalthigmo_full_4_minutes) #4.4%
shapiro.test(df$totalthigmo_full_4_minutes) 
sd(df$totalthigmo_full_4_minutes) #0.014 or std of 1.4%

#unique zones entered- AS A PROPORTION
max(df$unique_zones_entered) - min(df$unique_zones_entered) #0, ie all the same number of unique zones entered
#shapiro.test(df$unique_zones_entered) everyone got the same answer so can't run shapiro test
sd(df$unique_zones_entered) #0

#reaction time
max(df$reaction_time) - min(df$reaction_time) #bigggest difference between scorers is off by exactly 1 second (10.4 seconds and 9.4 seconds)
shapiro.test(df$reaction_time)
sd(df$reaction_time) #0.323 or an std of 0.3 seconds



```






