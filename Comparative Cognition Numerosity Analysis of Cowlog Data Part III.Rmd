---
title: "Comparative Cognition Numerosity Analysis of Cowlog data Part III"
author: "Kelly Wallace"
date: "March 21, 2018"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This script is going to incorportate the outpus from part II and add in a spreadsheet that has the detour data for the fish. 
Note- there are two ways to assess detour performance:
barrier problem- get around the barrier (minus time it took to get to barrier)
full social problem- enter the social reward zone (minus time it took to get to barrier)

Analaysis:

COMPARE NUMEROSITY AND DETOUR
Does latency to solve barrier problem predict average performance (full 4 minutes)?
Does latency to solve full solution problem predict average performance (full 4 minutes)?

Does latency to solve barrier problem predict average performance (T30 to T50)?
Does latency to solve full solution problem predict average performance (T30 to T50)?

Does latency to solve barrier problem predict latency to enter correct side?
Does latency to solve full solution problem predict latency to enter correct side?

WITHIN DETOUR (PERFORMANCE)
Does latency to solve barrier problem predict latency to solve full social problem?
How frequently do individuals only solve barrier problem but not full social problem(histogram)?
Do individuals who solve the full social problem have shorter latencies to solving the barrier problem (boxplot)

WITHIN DETOUR (OTHER BEHAVIORS)
Does proportion time in social reward predict latency to solve detour problem?
Does proportion time in social reward predict latency to solve full social problem?

Does latency to approach barrier predict latency to solve detour problem?
Does latency to approach barrier predict latency to solve full social problem?

Does latency to approach barrier predict time in social reward?
Do individuals who solve the barrier problem approach the barrier more quickly? (boxplot)
Do individual who solvev the full social problem approach the barrier more quickly? (boxplot)

OTHER FACTORS:
Does sex predict time to solve barrier problem?
Does sex predict time to solve full social problem?
Does sex predict if you solve barrier problem?
Does sex predict if you solve foll social problem?
Does sex predict latency to approach barrier?
Does sex predict proportion time in social reward?

Does size predict time to solve barrier problem?
Does size predict time to solve full social problem?
Does size predict if you solve barrier problem?
Does size predict if you solve foll social problem?
Does size predict latency to approach barrier?
Does size predict proportion time in social reward?

Does order predict time to solve barrier problem?
Does order predict time to solve full social problem?
Does order predict if you solve barrier problem?
Does order predict if you solve foll social problem?
Does order predict latency to approach barrier?
Does order predict proportion time in social reward?



```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(rmarkdown)
library(knitr)
library(readr)
library(utils)
library(EnvStats)

df<- read_csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Comparative Cognition R Scripts/Numerosity Comparative Cognition Full Dataset May_7_2018.csv", col_names = TRUE, col_types = NULL)

View(df)

det<- read_csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Detour/detour_data_for_R_April_5_2018.csv", col_names = TRUE, col_types = NULL)
View(det)

df.full<- full_join(df,det, by = 'fish_name')
df.full
df.full<-df.full %>% mutate(detour_trial_1_solved_code = detour_trial_1_did_fish_solve_barrier_problem + detour_trial_1_did_fish_solve_full_social_problem )
df.full$detour_trial_1_did_fish_solve_barrier_problem <-as.character(df.full$detour_trial_1_did_fish_solve_barrier_problem)
df.full$detour_trial_1_did_fish_solve_full_social_problem <-as.character(df.full$detour_trial_1_did_fish_solve_full_social_problem)
df.full<-df.full %>% mutate(detour_trial_1_latency_to_enter_reward_following_barrier_solution = detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier- detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)
df.full$number_of_medians_above_60_using_T30_to_T50_data<-as.numeric(df.full$number_of_medians_above_60_using_T30_to_T50_data)

#Note winthrop is removed because his detour trial 1 video started with fish in reward
#OPTIONAL WRITE OUT FULL CSV
#write_csv(df.full, filename = "Comparative Cognition Full Dataset Including Detour March_21_2017")
```

#TEMPLATE---------
Template:


mod<- lm(df$XXX ~ df$XXX, na.rm = TRUE)
summary(mod)

number <- df %>% filter(!is.na(XXX)) %>% filter(!is.na(XXX)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist


p <- ggplot(df, aes(XXX, XXX))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=50, y=0.5, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "XXX",y="XXX") +
  ggtitle ("XXX") +
  geom_smooth(method = "lm")




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict average performance (full 4 minutes)?

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_full_4_minutes_data ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_full_4_minutes_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_full_4_minutes_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_
       full_4_minutes_data") +
  ggtitle ("Note:Does latency to solve barrier problem predict average
           numerosity performance (full 4 minutes)?") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict average performance (T30 to T50)?

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_T30_to_T50_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=200, y=0.3, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_
       T30_to_T50_data") +
  ggtitle ("Note:Does latency to solve barrier problem predict average 
numerosity performance (T30 to T50)?") +
  geom_smooth(method = "lm")


```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve full solution problem predict average performance (full 4 minutes)?
mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_full_4_minutes_data ~ df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_full_4_minutes_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_full_4_minutes_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.2, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_full_problem_time_to_social_reward_
minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials
       _using_full_4_minutes_data") +
  ggtitle ("Note:Does latency to solve full solution problem predict average 
           performance (full 4 minutes)?") +
  geom_smooth(method = "lm")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve full solution problem predict average performance (T30 to T50)?
mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_T30_to_T50_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.2, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_T30_to_T50_data") +
  ggtitle ("Note:Does latency to solve full solution problem predict average
           performance (T30 to T50)?") +
  geom_smooth(method = "lm")


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict latency to solve full social problem?
mod<- lm(df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=300, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="detour_trial_1_full_problem_time_to_social_reward_
       minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to solve barrier problem predict latency to solve full social problem?") +
  geom_smooth(method = "lm")

#Note this is skewed because individuals who take longer to solve the detour will automatically have higher full social problem solution times because you have to do the barrier first
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict latency to enter reward zone following barrier solution?
mod<- lm(df.full$detour_trial_1_latency_to_enter_reward_following_barrier_solution ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(detour_trial_1_latency_to_enter_reward_following_barrier_solution)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, detour_trial_1_latency_to_enter_reward_following_barrier_solution))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=300, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") +
  ggtitle ("Does latency to solve barrier problem predict 
           latency to enter reward zone following barrier solution?") +
  geom_smooth(method = "lm")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does prop time in social reward following full social problem solution predict latenty to solve full social problem?
mod<- lm(df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier ~ df.full$detour_trial_1_prop_time_in_social_reward_following_solution, na.rm = TRUE)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_prop_time_in_social_reward_following_solution)) %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_prop_time_in_social_reward_following_solution, detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=0.7, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") +
  ggtitle ("Does latency to solve barrier problem predict 
           latency to enter reward zone following barrier solution?") +
  geom_smooth(method = "lm")

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#How frequently do individuals only solve barrier problem but not full social problem(histogram)?

ggplot(df.full, aes(detour_trial_1_solved_code, fill = sex.y))+
  geom_histogram() +
  ggtitle ("How many individuals did not solve (0), 
           only solved barrier(1) or solved barrier and entered reward zone(2)?")

#for anything that's slipt out by sex, use sex.y because that is the "sex" column from the detour data sheet which has the sex for individuals who we can't use their numerosity
```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the full social problem have shorter latencies to solving the barrier problem?

test<-t.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the full social problem have 
          shorter latencies to solving the barrier problem?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individual who solve the barrier problem have lower latencies to approach the barrier (higher motivation?)

test<-t.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individual who solve the barrier problem have lower latencies 
          to approach the barrier (higher motivation?)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individual who solev the full social problem have lower latencies to approach the barrier (higher motivation?)

test<-t.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individual who solve the full social problem have lower latencies 
          to approach the barrier (higher motivation?)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity performance over T30 to T50?

test<-t.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve 
          barrier problem) predict numerosity performance over T30 to T50?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity average latency to enter correct side?
test<-t.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_to_enter_correct_side)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus 
          did not solve barrier problem) predict numerosity average latency to enter correct side?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity average latency to enter correct side? filtered
test<-t.test(df.full$average_latency_to_enter_correct_side_filtered_just_correct_choice ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side_filtered_just_correct_choice~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_to_enter_correct_side_filtered_just_correct_choice)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus 
          did not solve barrier problem) predict numerosity average 
          latency to enter correct side? (filtered latency)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity performance (mean of medians)?
test<-t.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=mean_of_median_performance_on_each_ratio_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve barrier problem)
          predict numerosity performance (mean of medians)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance over T30 to T50?

test<-t.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve 
          barrier problem) predict numerosity performance over T30 to T50?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity average latency to enter correct side?
test<-t.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=average_latency_to_enter_correct_side)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus 
          did not solve barrier problem) predict numerosity average latency to enter correct side?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance (mean of medians)?
test<-t.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=mean_of_median_performance_on_each_ratio_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve barrier problem)
          predict numerosity performance (mean of medians)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to approach barrier predict latency to solve barrier problem?

mod<- lm(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full$time_to_barrier_contact_minus_start_time)
summary(mod)

number <- df.full %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(time_to_barrier_contact_minus_start_time, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, color = sex.y))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "time_to_barrier_contact_minus_start_time",y="detour_trial_1_barrier_problem_time_
       around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to approach barrier predict latency to solve barrier problem??") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance (proportion of correct first choices?
test<-t.test(df.full$proportion_of_correct_first_choices ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$proportion_of_correct_first_choices ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=proportion_of_correct_first_choices)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve barrier problem)
          predict numerosity performance (prop correct first choices)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does solving the detour predict if fish had a median above 60?

mod<- lm(df.full$did_fish_have_a_median_above_60 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
summary(mod)

number <- df.full %>% filter(!is.na(did_fish_have_a_median_above_60)) %>% filter(!is.na(detour_trial_1_did_fish_solve_barrier_problem)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_did_fish_solve_barrier_problem, did_fish_have_a_median_above_60, color = did_fish_have_a_median_above_60))
p + geom_jitter(width = 0.3, height = 0.3, size = 4) + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=1, y=1,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
  #      n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_did_fish_solve_barrier_problem",y="did_fish_have_a_median_above_60") +
  ggtitle ("Note:Does solving the detour predict if a fish had a median above 60 on at least 1 median?") 

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve the the detour predict if fish had a median above 60?

mod<- lm(df.full$did_fish_have_a_median_above_60 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
summary(mod)

number <- df.full %>% filter(!is.na(did_fish_have_a_median_above_60)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, did_fish_have_a_median_above_60, color = did_fish_have_a_median_above_60))
p + geom_jitter(width = 0.3, height = 0.3, size = 4) + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=1, y=1,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
  #      n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_
       time_around_barrier_minus_time_to_contact_barrier",y="did_fish_have_a_median_above_60") +
  ggtitle ("Note:Does latency to solve the  the detour predict if a fish had a median above 60 on at least 1 median?") 

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#How frequently do individuals solve both barrier problem and learn numerosity??
df.full$did_fish_have_a_median_above_60<-as.factor(df.full$did_fish_have_a_median_above_60)
df.full$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.full$detour_trial_1_did_fish_solve_barrier_problem)
                                                                 

ggplot(df.full, aes(detour_trial_1_did_fish_solve_barrier_problem, fill = did_fish_have_a_median_above_60))+
  geom_histogram(aes(width = 20)) +
  ggtitle ("How many individuals solved detour barrier, and of those
           how many learned numerosity?")


```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity entries full four predict detour solve?
df.full$detour_trial_1_did_fish_solve_barrier_problem<-as.factor(df.full$detour_trial_1_did_fish_solve_barrier_problem)

test<-t.test(df.full$average_number_of_entries_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity entries full four predict detour solve??') +
  geom_text(x=1, y=10, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity entries T0-29 predict detour solve?
test<-t.test(df.full$average_number_of_entries_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity entries T0-29 predict detour solve??') +
  geom_text(x=1, y=5, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time thigmo  predict detour solve?
test<-t.test(df.full$average_prop_time_thigmo_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_thigmo_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_thigmo_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time thigmo predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time mirror predict detour solve?
test<-t.test(df.full$average_prop_time_mirror_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_mirror_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_mirror_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time mirror predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict detour solve?
test<-t.test(df.full$standard_length ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$standard_length ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=standard_length)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does standard lengthr predict detour solve??') +
  geom_text(x=1, y=2000, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


COMPARE NUMEROSITY AND DETOUR
Does latency to solve barrier problem predict average performance (full 4 minutes)?
Does latency to solve full solution problem predict average performance (full 4 minutes)?

Does latency to solve barrier problem predict average performance (T30 to T50)?
Does latency to solve full solution problem predict average performance (T30 to T50)?

Does latency to solve barrier problem predict latency to enter correct side?
Does latency to solve full solution problem predict latency to enter correct side?

WITHIN DETOUR (PERFORMANCE)
Does latency to solve barrier problem predict latency to solve full social problem?
How frequently do individuals only solve barrier problem but not full social problem(histogram)?
Do individuals who solve the full social problem have shorter latencies to solving the barrier problem (boxplot)

WITHIN DETOUR (OTHER BEHAVIORS)
Does proportion time in social reward predict latency to solve detour problem?
Does proportion time in social reward predict latency to solve full social problem?

Does latency to approach barrier predict latency to solve detour problem?
Does latency to approach barrier predict latency to solve full social problem?

Does latency to approach barrier predict time in social reward?
Do individuals who solve the barrier problem approach the barrier more quickly? (boxplot)
Do individual who solvev the full social problem approach the barrier more quickly? (boxplot)

OTHER FACTORS:
Does sex predict time to solve barrier problem?
Does sex predict time to solve full social problem?
Does sex predict if you solve barrier problem?
Does sex predict if you solve foll social problem?
Does sex predict latency to approach barrier?
Does sex predict proportion time in social reward?

Does size predict time to solve barrier problem?
Does size predict time to solve full social problem?
Does size predict if you solve barrier problem?
Does size predict if you solve foll social problem?
Does size predict latency to approach barrier?
Does size predict proportion time in social reward?

Does order predict time to solve barrier problem?
Does order predict time to solve full social problem?
Does order predict if you solve barrier problem?
Does order predict if you solve foll social problem?
Does order predict latency to approach barrier?
Does order predict proportion time in social reward?










