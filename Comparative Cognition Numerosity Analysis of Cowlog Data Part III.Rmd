---
title: "Comparative Cognition Numerosity Analysis of Cowlog data Part III"
author: "Kelly Wallace"
date: "March 21, 2018"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This script is going to incorportate the outpus from part II and add in a spreadsheet that has the detour data for the fish. 
Note- there are two ways to assess detour performance:
barrier problem- get around the barrier (minus time it took to get to barrier)
full social problem- enter the social reward zone (minus time it took to get to barrier)

Analaysis:

COMPARE NUMEROSITY AND DETOUR
Does latency to solve barrier problem predict average performance (full 4 minutes)?
Does latency to solve full solution problem predict average performance (full 4 minutes)?

Does latency to solve barrier problem predict average performance (T30 to T50)?
Does latency to solve full solution problem predict average performance (T30 to T50)?

Does latency to solve barrier problem predict latency to enter correct side?
Does latency to solve full solution problem predict latency to enter correct side?

WITHIN DETOUR (PERFORMANCE)
Does latency to solve barrier problem predict latency to solve full social problem?
How frequently do individuals only solve barrier problem but not full social problem(histogram)?
Do individuals who solve the full social problem have shorter latencies to solving the barrier problem (boxplot)

WITHIN DETOUR (OTHER BEHAVIORS)
Does proportion time in social reward predict latency to solve detour problem?
Does proportion time in social reward predict latency to solve full social problem?

Does latency to approach barrier predict latency to solve detour problem?
Does latency to approach barrier predict latency to solve full social problem?

Does latency to approach barrier predict time in social reward?
Do individuals who solve the barrier problem approach the barrier more quickly? (boxplot)
Do individual who solvev the full social problem approach the barrier more quickly? (boxplot)

OTHER FACTORS:
Does sex predict time to solve barrier problem?
Does sex predict time to solve full social problem?
Does sex predict if you solve barrier problem?
Does sex predict if you solve foll social problem?
Does sex predict latency to approach barrier?
Does sex predict proportion time in social reward?

Does size predict time to solve barrier problem?
Does size predict time to solve full social problem?
Does size predict if you solve barrier problem?
Does size predict if you solve foll social problem?
Does size predict latency to approach barrier?
Does size predict proportion time in social reward?

Does order predict time to solve barrier problem?
Does order predict time to solve full social problem?
Does order predict if you solve barrier problem?
Does order predict if you solve foll social problem?
Does order predict latency to approach barrier?
Does order predict proportion time in social reward?



```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(rmarkdown)
library(knitr)
library(readr)
library(utils)
library(EnvStats)
library(waffle)
library(extrafont)

df<- read_csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Comparative Cognition R Scripts/Numerosity Comparative Cognition Full Dataset July_20_2018.csv", col_names = TRUE, col_types = NULL)

View(df)

det<- read_csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Detour/detour_data_for_R_April_5_2018.csv", col_names = TRUE, col_types = NULL)
View(det)

df.full<- full_join(df,det, by = 'fish_name')
df.full
df.full<-df.full %>% mutate(detour_trial_1_solved_code = detour_trial_1_did_fish_solve_barrier_problem + detour_trial_1_did_fish_solve_full_social_problem )
df.full$detour_trial_1_did_fish_solve_barrier_problem <-as.character(df.full$detour_trial_1_did_fish_solve_barrier_problem)
df.full$detour_trial_1_did_fish_solve_full_social_problem <-as.character(df.full$detour_trial_1_did_fish_solve_full_social_problem)
df.full<-df.full %>% mutate(detour_trial_1_latency_to_enter_reward_following_barrier_solution = detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier- detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)
df.full$number_of_medians_above_60_using_T30_to_T50_data<-as.numeric(df.full$number_of_medians_above_60_using_T30_to_T50_data)

df.full.females<- df.full %>% filter(sex.y == "F")
df.full.males<- df.full %>% filter(sex.y == "M")


#Note winthrop is removed because his detour trial 1 video started with fish in reward
#OPTIONAL WRITE OUT FULL CSV
#write_csv(df.full, filename = "Comparative Cognition Full Dataset Including Detour March_21_2017")
```

#TEMPLATE---------
Template:


mod<- lm(df$XXX ~ df$XXX, na.rm = TRUE)
summary(mod)

number <- df %>% filter(!is.na(XXX)) %>% filter(!is.na(XXX)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist


p <- ggplot(df, aes(XXX, XXX))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=50, y=0.5, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "XXX",y="XXX") +
  ggtitle ("XXX") +
  geom_smooth(method = "lm")


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does sex predict solving the barrier problem?

test<-t.test(df.full$detour_trial_1_did_fish_solve_barrier_problem~df.full$sex.y)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$detour_trial_1_did_fish_solve_barrier_problem~df.full$sex.y)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=sex.y, y=detour_trial_1_did_fish_solve_barrier_problem)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does sex predict solving the barrier problem?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does sex predict latency to solve the barrier problem?
shapiro.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)
#if shapiro wilk is NOT significant, use a t test

test<-t.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$sex.y)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$sex.y)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=sex.y, y=detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does sex predict latency to solve the barrier problem?') +
  geom_text(x=1, y=0.1, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does sex predict latency to approach barrier?

shapiro.test(df.full$time_to_barrier_contact_minus_start_time)
#if shapiro wilk is NOT significant, use a t test

test<-t.test(df.full$time_to_barrier_contact_minus_start_time~df.full$sex.y)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$time_to_barrier_contact_minus_start_time~df.full$sex.y)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=sex.y, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does sex predict latency to approach barrier') +
  geom_text(x=1, y=0.1, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict average performance (full 4 minutes)?

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_full_4_minutes_data ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_full_4_minutes_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_full_4_minutes_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_
       full_4_minutes_data") +
  ggtitle ("Note:Does latency to solve barrier problem predict average
           numerosity performance (full 4 minutes)?") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict average performance (T30 to T50)?

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_T30_to_T50_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=200, y=0.3, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_
       T30_to_T50_data") +
  ggtitle ("Note:Does latency to solve barrier problem predict average 
numerosity performance (T30 to T50)?") +
  geom_smooth(method = "lm")


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve full social problem predict average performance (T30 to T50)?

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_T30_to_T50_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=200, y=0.3, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_full_problem_time_to_social_reward_
minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_
       T30_to_T50_data") +
  ggtitle ("Note:Does latency to solve full social problem predict average 
numerosity performance (T30 to T50)?") +
  geom_smooth(method = "lm")


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve full solution problem predict average performance (full 4 minutes)?
mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_full_4_minutes_data ~ df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_full_4_minutes_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_full_4_minutes_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.2, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_full_problem_time_to_social_reward_
minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials
       _using_full_4_minutes_data") +
  ggtitle ("Note:Does latency to solve full solution problem predict average 
           performance (full 4 minutes)?") +
  geom_smooth(method = "lm")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve full solution problem predict average performance (T30 to T50)?
mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier, average_performance_across_all_9_testing_trials_using_T30_to_T50_data))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.2, label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier",y="average_performance_across_all_9_testing_trials_using_T30_to_T50_data") +
  ggtitle ("Note:Does latency to solve full solution problem predict average
           performance (T30 to T50)?") +
  geom_smooth(method = "lm")


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict latency to solve full social problem?
mod<- lm(df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=300, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_time_around_barrier_
       minus_time_to_contact_barrier",y="detour_trial_1_full_problem_time_to_social_reward_
       minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to solve barrier problem predict latency to solve full social problem?") +
  geom_smooth(method = "lm")

#Note this is skewed because individuals who take longer to solve the detour will automatically have higher full social problem solution times because you have to do the barrier first
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve barrier problem predict latency to enter reward zone following barrier solution?
mod<- lm(df.full$detour_trial_1_latency_to_enter_reward_following_barrier_solution ~ df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, na.rm = TRUE)
summary(mod)


number <- df.full %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% filter(!is.na(detour_trial_1_latency_to_enter_reward_following_barrier_solution)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, detour_trial_1_latency_to_enter_reward_following_barrier_solution))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=300, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") +
  ggtitle ("Does latency to solve barrier problem predict 
           latency to enter reward zone following barrier solution?") +
  geom_smooth(method = "lm")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does prop time in social reward following full social problem solution predict latenty to solve full social problem?
mod<- lm(df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier ~ df.full$detour_trial_1_prop_time_in_social_reward_following_solution, na.rm = TRUE)
summary(mod)

number <- df.full %>% filter(!is.na(detour_trial_1_prop_time_in_social_reward_following_solution)) %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_prop_time_in_social_reward_following_solution, detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=0.7, y=100, label= glue::glue("p = {round(p_value,8)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") +
  ggtitle ("Does latency to solve barrier problem predict 
           latency to enter reward zone following barrier solution?") +
  geom_smooth(method = "lm")

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#How frequently do individuals only solve barrier problem but not full social problem(histogram)?

ggplot(df.full, aes(detour_trial_1_solved_code, fill = sex.y))+
  geom_histogram(aes(width = 12)) +
  ggtitle ("How many individuals did not solve (0), 
           only solved barrier(1) or solved barrier and entered reward zone(2)?")

#for anything that's slipt out by sex, use sex.y because that is the "sex" column from the detour data sheet which has the sex for individuals who we can't use their numerosity
```






```{r, echo=FALSE, message=FALSE, warning=FALSE}
#How frequently do individuals only solve barrier problem but not full social problem(histogram)?
library(waffle)
library(extrafont)
font_import()


 solvers<- c(14,13)
 nonsolvers<-c(13,12)
 w1 <- waffle(solvers, rows = 2)
 w2 <- waffle(nonsolvers, rows = 2)
 iron (w1, w2)
 
 solvers = c(14,13)
nonsolvers = c(13,12)
detoursolvesex<-data.frame(solvers,nonsolvers)
chisq.test(detoursolvesex)
 

ggplot(df.full, aes(detour_trial_1_solved_code, fill = sex.y))+
  geom_histogram(aes(width = 12)) +
  ggtitle ("How many individuals did not solve (0), 
           only solved barrier(1) or solved barrier and entered reward zone(2)?")

#for anything that's slipt out by sex, use sex.y because that is the "sex" column from the detour data sheet which has the sex for individuals who we can't use their numerosity
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the full social problem have shorter latencies to solving the barrier problem?

test<-t.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the full social problem have 
          shorter latencies to solving the barrier problem?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```









```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individual who solve the barrier problem have lower latencies to approach the barrier (higher motivation?)

test<-t.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individual who solve the barrier problem have lower latencies 
          to approach the barrier (higher motivation?)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individual who solve the barrier problem have lower latencies to approach the barrier (higher motivation?)MALES

test<-t.test(df.full.males$time_to_barrier_contact_minus_start_time~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$time_to_barrier_contact_minus_start_time~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individual who solve the barrier problem have lower latencies 
          to approach the barrier (higher motivation?)MALES') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individual who solev the full social problem have lower latencies to approach the barrier (higher motivation?)

test<-t.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$time_to_barrier_contact_minus_start_time~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=time_to_barrier_contact_minus_start_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individual who solve the full social problem have lower latencies 
          to approach the barrier (higher motivation?)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity performance over T30 to T50?

test<-t.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve 
          barrier problem) predict numerosity performance over T30 to T50?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity average latency to enter correct side?
test<-t.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_to_enter_correct_side)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus 
          did not solve barrier problem) predict numerosity average latency to enter correct side?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity average latency to enter correct side? filtered
test<-t.test(df.full$average_latency_to_enter_correct_side_filtered_just_correct_choice ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side_filtered_just_correct_choice~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_to_enter_correct_side_filtered_just_correct_choice)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus 
          did not solve barrier problem) predict numerosity average 
          latency to enter correct side? (filtered latency)') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved barrier problem versus did not solve barrier problem) predict numerosity performance (mean of medians)?
test<-t.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=mean_of_median_performance_on_each_ratio_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve barrier problem)
          predict numerosity performance (mean of medians)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance over T30 to T50?

test<-t.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved full social problem versus did not solve 
          barrier problem) predict numerosity performance over T30 to T50?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity average latency to enter correct side?
test<-t.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_to_enter_correct_side~df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=average_latency_to_enter_correct_side)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved full socical problem versus 
          did not solve barrier problem) predict numerosity average latency to enter correct side?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance (mean of medians)?
test<-t.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$mean_of_median_performance_on_each_ratio_T30_to_T50_data ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=mean_of_median_performance_on_each_ratio_T30_to_T50_data)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved social problem versus did not solve barrier problem)
          predict numerosity performance (mean of medians)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to approach barrier predict latency to solve full social problem?

mod<- lm(df.full$detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier ~ df.full$time_to_barrier_contact_minus_start_time)
summary(mod)

number <- df.full %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% filter(!is.na(detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(time_to_barrier_contact_minus_start_time, detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "time_to_barrier_contact_minus_start_time",y="detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to approach barrier predict latency to solve full social problem??") +
  geom_smooth(method = "lm")

```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to approach barrier predict latency to solve barrier problem?

mod<- lm(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full$time_to_barrier_contact_minus_start_time)
summary(mod)

number <- df.full %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(time_to_barrier_contact_minus_start_time, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "time_to_barrier_contact_minus_start_time",y="detour_trial_1_barrier_problem_time_
       around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to approach barrier predict latency to solve barrier problem??") +
  geom_smooth(method = "lm")

```





```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to approach barrier predict latency to solve barrier problem?

mod<- lm(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full$time_to_barrier_contact_minus_start_time)
summary(mod)

number <- df.full %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(time_to_barrier_contact_minus_start_time, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, color = sex.y))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=150, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "time_to_barrier_contact_minus_start_time",y="detour_trial_1_barrier_problem_time_
       around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does latency to approach barrier predict latency to solve barrier problem??") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does Detour category (solved full social problem versus did not solve barrier problem) predict numerosity performance (proportion of correct first choices?
test<-t.test(df.full$proportion_of_correct_first_choices ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$proportion_of_correct_first_choices ~ df.full$detour_trial_1_did_fish_solve_full_social_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_full_social_problem, y=proportion_of_correct_first_choices)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does Detour category (solved barrier problem versus did not solve barrier problem)
          predict numerosity performance (prop correct first choices)?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does solving the detour predict if fish had a median above 60?

mod<- lm(df.full$did_fish_have_a_median_above_60 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
summary(mod)

number <- df.full %>% filter(!is.na(did_fish_have_a_median_above_60)) %>% filter(!is.na(detour_trial_1_did_fish_solve_barrier_problem)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_did_fish_solve_barrier_problem, did_fish_have_a_median_above_60, color = did_fish_have_a_median_above_60))
p + geom_jitter(width = 0.3, height = 0.3, size = 4) + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=1, y=1,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
  #      n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_did_fish_solve_barrier_problem",y="did_fish_have_a_median_above_60") +
  ggtitle ("Note:Does solving the detour predict if a fish had a median above 60 on at least 1 median?") 

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does latency to solve the the detour predict if fish had a median above 60? WRONG NOT A LATENCY

mod<- lm(df.full$did_fish_have_a_median_above_60 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
summary(mod)

number <- df.full %>% filter(!is.na(did_fish_have_a_median_above_60)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier, did_fish_have_a_median_above_60, color = did_fish_have_a_median_above_60))
p + geom_jitter(width = 0.3, height = 0.3, size = 4) + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=1, y=1,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
  #      n = {number}"), size = 6, color = "black") + 
  labs(x= "detour_trial_1_barrier_problem_
       time_around_barrier_minus_time_to_contact_barrier",y="did_fish_have_a_median_above_60") +
  ggtitle ("Note:Does latency to solve the  the detour predict if a fish had a median above 60 on at least 1 median?") 

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#How frequently do individuals solve both barrier problem and learn numerosity??
df.full$did_fish_have_a_median_above_60<-as.factor(df.full$did_fish_have_a_median_above_60)
df.full$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.full$detour_trial_1_did_fish_solve_barrier_problem)
    

df.full.detoursolvers<- df.full%>% filter(detour_trial_1_did_fish_solve_barrier_problem == 1)
nrow(df.full.detoursolvers) #27
nrow(df.full.detoursolvers %>% filter(did_fish_have_a_median_above_60 == 1)) #13
nrow(df.full.detoursolvers %>% filter(did_fish_have_a_median_above_60 == 0)) #5
nrow(df.full.detoursolvers %>% filter(is.na(did_fish_have_a_median_above_60) == TRUE)) #9

df.full.detournonsolvers<- df.full%>% filter(detour_trial_1_did_fish_solve_barrier_problem == 0)
nrow(df.full.detournonsolvers) #25
nrow(df.full.detournonsolvers %>% filter(did_fish_have_a_median_above_60 == 1)) #10
nrow(df.full.detournonsolvers %>% filter(did_fish_have_a_median_above_60 == 0)) #8
nrow(df.full.detournonsolvers %>% filter(is.na(did_fish_have_a_median_above_60) == TRUE)) #7                                                            
 solvers<- c(13,5)
 nonsolvers<-c(10,8)
 w1 <- waffle(solvers, rows = 2)
 w2 <- waffle(nonsolvers, rows = 2)
 iron (w1, w2)

df.chi2<- read_csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Comparative Cognition R Scripts/detour_solvers.csv")
chisq.test(df.chi2)

ggplot(df.full, aes(detour_trial_1_did_fish_solve_barrier_problem, fill = did_fish_have_a_median_above_60))+
  geom_histogram(aes(width = 20)) +
  ggtitle ("How many individuals solved detour barrier, and of those
           how many learned numerosity?")


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.full.detoursolvers<- df.full%>% filter(detour_trial_1_did_fish_solve_barrier_problem == 1)
df.full.detournonsolvers<- df.full%>% filter(detour_trial_1_did_fish_solve_barrier_problem == 0)

df.full.detoursolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 0) %>% nrow() #5
df.full.detoursolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 1) %>% nrow() #6
df.full.detoursolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 2) %>% nrow() #7
df.full.detoursolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 3) %>% nrow() #0

df.full.detournonsolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 0) %>% nrow() #8
df.full.detournonsolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 1) %>% nrow() #7
df.full.detournonsolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 2) %>% nrow() #2
df.full.detournonsolvers %>% filter(number_of_medians_above_60_using_T30_to_T50_data == 3) %>% nrow() #1


 solvers<- c(5,6,7,0)
 nonsolvers<-c(8,7,2,1)
 w1 <- waffle(solvers, rows = 2)
 w2 <- waffle(nonsolvers, rows = 2)
 iron (w1, w2)
 
 
solvers = c(5,6,7,0)
nonsolvers = c(8,7,2,1)
detoursolvemedian<-data.frame(solvers,nonsolvers)
chisq.test(detoursolvemedian)


#I'm going to now run the chi2 test again, but my two groups will just be num high solvers (learned 2+ median) to everyone else (0-1 medians learned)
solvers23 = c(11,7)
nonsolvers01 = c(15,3)
detourbynum23vs01<-data.frame(solvers23,nonsolvers01)
chisq.test(detourbynum23vs01)



```





```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity entries full four predict detour solve?
df.full$detour_trial_1_did_fish_solve_barrier_problem<-as.factor(df.full$detour_trial_1_did_fish_solve_barrier_problem)

test<-t.test(df.full$average_number_of_entries_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity entries full four predict detour solve??') +
  geom_text(x=1, y=10, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity entries T0-29 predict detour solve?
test<-t.test(df.full$average_number_of_entries_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity entries T0-29 predict detour solve??') +
  geom_text(x=1, y=5, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time thigmo 0-29 predict detour solve?
test<-t.test(df.full$average_prop_time_thigmo_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_thigmo_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_thigmo_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time thigmo 0-29 predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time mirror 0-29 predict detour solve?
test<-t.test(df.full$average_prop_time_mirror_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_mirror_T0_to_T29 ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_mirror_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time mirror 0-29 predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time thigmo full 4 minutes predict detour solve?
test<-t.test(df.full$totalthigmo_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$totalthigmo_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalthigmo_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time thigmo full 4 minutes predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does numerosity prop time mirror full 4 minutes predict detour solve?
test<-t.test(df.full$totalmirror_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$totalmirror_full_4_minutes ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalmirror_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does numerosity prop time mirror full 4 minutes predict detour solve??') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict detour solve?
shapiro.test(df.full$standard_length) #non-significant, does not deviate from normality, use t test
test<-t.test(df.full$standard_length ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$standard_length ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=standard_length)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does standard length predict detour solve??') +
  geom_text(x=1, y=2000, label= glue::glue("p (t-test)= {round(p_value_t,4)}"), size = 6, color = "black")
p

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict detour solve?FEMALES

shapiro.test(df.full.females$standard_length) #significant, so wilcox
test<-t.test(df.full.females$standard_length ~ df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$standard_length ~ df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=standard_length)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does standard length predict detour solve??FEMALES') +
  geom_text(x=1, y=2000, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "red")
p

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict detour solve?MALES

shapiro.test(df.full.males$standard_length) #significant, so wilcox
test<-t.test(df.full.males$standard_length ~ df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$standard_length ~ df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=standard_length)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Does standard length predict detour solve??MALES') +
  geom_text(x=1, y=2000, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "blue")
p

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to solve detour? SEXES COMBINED

mod<- lm(df.full$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full$standard_length)
summary(mod)

number <- df.full %>% filter(!is.na(standard_length)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(standard_length, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "black") + 
  labs(x= "standard_legnth",y="detour_trial_1_barrier_problem_time
       _around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does standard length predict latency to solve detour?SEXES COMBINED") +
  geom_smooth(method = "lm")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to solve detour?FEMALES

mod<- lm(df.full.females$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full.females$standard_length)
summary(mod)

number <- df.full.females %>% filter(!is.na(standard_length)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full.females, aes(standard_length, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "red") + 
  labs(x= "standard_legnth",y="detour_trial_1_barrier_problem_time
       _around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does standard length predict latency to solve detour?FEMALES") +
  geom_smooth(method = "lm")

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to solve detour?MALES

mod<- lm(df.full.males$detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier ~ df.full.males$standard_length)
summary(mod)

number <- df.full.males %>% filter(!is.na(standard_length)) %>% filter(!is.na(detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full.males, aes(standard_length, detour_trial_1_barrier_problem_time_around_barrier_minus_time_to_contact_barrier))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "blue") + 
  labs(x= "standard_legnth",y="detour_trial_1_barrier_problem_time
       _around_barrier_minus_time_to_contact_barrier") +
  ggtitle ("Note:Does standard length predict latency to solve detour?MALES") +
  geom_smooth(method = "lm")

```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to approach barrier?FEMALES

mod<- lm(df.full.females$time_to_barrier_contact_minus_start_time ~ df.full.females$standard_length)
summary(mod)

number <- df.full.females %>% filter(!is.na(standard_length)) %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full.females, aes(standard_length, time_to_barrier_contact_minus_start_time))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "red") + 
  labs(x= "standard_legnth",y="latency to approach barrier") +
  ggtitle ("Note:Does standard length predict latency to approach barrier?FEMALES") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to approach barrier?MALES

mod<- lm(df.full.males$time_to_barrier_contact_minus_start_time ~ df.full.males$standard_length)
summary(mod)

number <- df.full.males %>% filter(!is.na(standard_length)) %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full.males, aes(standard_length, time_to_barrier_contact_minus_start_time))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6, color = "blue") + 
  labs(x= "standard_legnth",y="latency to approach barrier") +
  ggtitle ("Note:Does standard length predict latency to approach barrier?MALES") +
  geom_smooth(method = "lm")

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Does standard length predict latency to approach barrier?

mod<- lm(df.full$time_to_barrier_contact_minus_start_time ~ df.full$standard_length)
summary(mod)

number <- df.full %>% filter(!is.na(standard_length)) %>% filter(!is.na(time_to_barrier_contact_minus_start_time)) %>% nrow
p_value <- mod %>% broom::tidy() %>% filter(term != "(Intercept)") %>% select(p.value) %>% unlist
r_squared <- mod %>% broom::glance() %>% select(r.squared) %>% unlist

p <- ggplot(df.full, aes(standard_length, time_to_barrier_contact_minus_start_time))
p + geom_point(size = 3) + 
  theme(text = element_text(size=10)) + 
  annotate("text", x=2000, y=0.3,label= glue::glue("p = {round(p_value,4)}, R-squared:  {round(r_squared,3)}
        n = {number}"), size = 6) + 
  labs(x= "standard_legnth",y="latency to approach barrier") +
  ggtitle ("Note:Does standard length predict latency to approach barrier?") +
  geom_smooth(method = "lm")

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_T0_to_T29?

test<-t.test(df.full$average_number_of_entries_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_T0_to_T29?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_T0_to_T29?females

test<-t.test(df.full.females$average_number_of_entries_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_number_of_entries_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_T0_to_T29?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_T0_to_T29?males

test<-t.test(df.full.males$average_number_of_entries_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_number_of_entries_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_T0_to_T29?males') +
  geom_text(x=1, y=3, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_full_4_minutes?

test<-t.test(df.full$average_number_of_entries_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_number_of_entries_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_full_4_minutes?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_full_4_minutes?females

test<-t.test(df.full.females$average_number_of_entries_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_number_of_entries_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_full_4_minutes?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_number_of_entries_full_4_minutes?males

test<-t.test(df.full.males$average_number_of_entries_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_number_of_entries_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_number_of_entries_full_4_minutes?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have unique_zones_entered_full_4_minutes?

test<-t.test(df.full$unique_zones_entered_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$unique_zones_entered_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          unique_zones_entered_full_4_minutes?') +
  geom_text(x=1, y=6, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have unique_zones_entered_full_4_minutes?females

test<-t.test(df.full.females$unique_zones_entered_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$unique_zones_entered_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          unique_zones_entered_full_4_minutes?females') +
  geom_text(x=1, y=4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have unique_zones_entered_full_4_minutes?males

test<-t.test(df.full.males$unique_zones_entered_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$unique_zones_entered_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          unique_zones_entered_full_4_minutes?males') +
  geom_text(x=1, y=6, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_thigmo_T0_to_T29?

test<-t.test(df.full$average_prop_time_thigmo_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_thigmo_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_thigmo_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_thigmo_T0_to_T29?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_thigmo_T0_to_T29?females

test<-t.test(df.full.females$average_prop_time_thigmo_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_prop_time_thigmo_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_thigmo_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_thigmo_T0_to_T29?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_thigmo_T0_to_T29?males

test<-t.test(df.full.males$average_prop_time_thigmo_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_prop_time_thigmo_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_thigmo_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_thigmo_T0_to_T29?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalthigmo_full_4_minutes?

test<-t.test(df.full$totalthigmo_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$totalthigmo_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalthigmo_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalthigmo_full_4_minutes?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalthigmo_full_4_minutes?females

test<-t.test(df.full.females$totalthigmo_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$totalthigmo_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalthigmo_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalthigmo_full_4_minutes?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalthigmo_full_4_minutes?males

test<-t.test(df.full.males$totalthigmo_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$totalthigmo_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalthigmo_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalthigmo_full_4_minutes?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalmirror_full_4_minutes?

test<-t.test(df.full$totalmirror_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$totalmirror_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalmirror_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalmirror_full_4_minutes?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalmirror_full_4_minutes?females

test<-t.test(df.full.females$totalmirror_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$totalmirror_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalmirror_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalmirror_full_4_minutes?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have totalmirror_full_4_minutes?males
shapiro.test(df.full.males$totalmirror_full_4_minutes)
#if shapiro wilk is NOT significant, use a t test


test<-t.test(df.full.males$totalmirror_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$totalmirror_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=totalmirror_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          totalmirror_full_4_minutes?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_mirror_T0_to_T29?

test<-t.test(df.full$average_prop_time_mirror_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_mirror_T0_to_T29~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_mirror_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_mirror_T0_to_T29?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_mirror_T0_to_T29?females

test<-t.test(df.full.females$average_prop_time_mirror_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_prop_time_mirror_T0_to_T29~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_mirror_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_mirror_T0_to_T29?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_mirror_T0_to_T29?males

test<-t.test(df.full.males$average_prop_time_mirror_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_prop_time_mirror_T0_to_T29~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_mirror_T0_to_T29)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_mirror_T0_to_T29?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have entries_into_center_full_4_minutes?

test<-t.test(df.full$entries_into_center_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$entries_into_center_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=entries_into_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          entries_into_center_full_4_minutes?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have entries_into_center_full_4_minutes?females

test<-t.test(df.full.females$entries_into_center_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$entries_into_center_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=entries_into_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          entries_into_center_full_4_minutes?females') +
  geom_text(x=1, y=10, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have entries_into_center_full_4_minutes?males

test<-t.test(df.full.males$entries_into_center_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$entries_into_center_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=entries_into_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          entries_into_center_full_4_minutes?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```
```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_reaction_time?

test<-t.test(df.full$average_reaction_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_reaction_time~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_reaction_time?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_reaction_time?females

test<-t.test(df.full.females$average_reaction_time~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_reaction_time~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_reaction_time?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_reaction_time?males

test<-t.test(df.full.males$average_reaction_time~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_reaction_time~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_reaction_time?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

#Does solving detour predict latency to enter either screen? (decision speed)
test<-t.test(df.full$average_latency_enter_either_screen ~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_latency_enter_either_screen~ df.full$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_enter_either_screen)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=3, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does solving detour predict latency to enter
              either screen? (decision speed)?")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

#Does solving detour predict latency to enter either screen? (decision speed)FEMALES
test<-t.test(df.full.females$average_latency_enter_either_screen ~ df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_latency_enter_either_screen~ df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_enter_either_screen)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=3, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does solving detour predict latency to enter
              either screen? (decision speed)? FEMALES")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

#Does solving detour predict latency to enter either screen? (decision speed)males
test<-t.test(df.full.males$average_latency_enter_either_screen ~ df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_latency_enter_either_screen~ df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_latency_enter_either_screen)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=3, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does solving detour predict latency to enter
              either screen? (decision speed)? males")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_center_full_4_minutes?

test<-t.test(df.full$average_prop_time_center_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$average_prop_time_center_full_4_minutes~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_center_full_4_minutes?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_center_full_4_minutes?females

test<-t.test(df.full.females$average_prop_time_center_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$average_prop_time_center_full_4_minutes~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_center_full_4_minutes?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have average_prop_time_center_full_4_minutes?males

test<-t.test(df.full.males$average_prop_time_center_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$average_prop_time_center_full_4_minutes~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_prop_time_center_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          average_prop_time_center_full_4_minutes?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```



#############TEMPLATE
```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have XXX?

test<-t.test(df.full$XXX~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full$XXX~df.full$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=XXX)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          XXX?') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have XXX?females

test<-t.test(df.full.females$XXX~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.females$XXX~df.full.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=XXX)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          XXX?females') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#Do individuals who solve the barrier problem have XXX?males

test<-t.test(df.full.males$XXX~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test %>% broom::tidy() %>% select(p.value) %>% unlist
wilcox_test<-wilcox.test(df.full.males$XXX~df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.full.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=XXX)) + 
  geom_boxplot()+ stat_n_text() +
  ggtitle('Do individuals who solve the barrier problem have 
          XXX?males') +
  geom_text(x=1, y=0.1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p


```

COMPARE NUMEROSITY AND DETOUR
Does latency to solve barrier problem predict average performance (full 4 minutes)?
Does latency to solve full solution problem predict average performance (full 4 minutes)?

Does latency to solve barrier problem predict average performance (T30 to T50)?
Does latency to solve full solution problem predict average performance (T30 to T50)?

Does latency to solve barrier problem predict latency to enter correct side?
Does latency to solve full solution problem predict latency to enter correct side?

WITHIN DETOUR (PERFORMANCE)
Does latency to solve barrier problem predict latency to solve full social problem?
How frequently do individuals only solve barrier problem but not full social problem(histogram)?
Do individuals who solve the full social problem have shorter latencies to solving the barrier problem (boxplot)

WITHIN DETOUR (OTHER BEHAVIORS)
Does proportion time in social reward predict latency to solve detour problem?
Does proportion time in social reward predict latency to solve full social problem?

Does latency to approach barrier predict latency to solve detour problem?
Does latency to approach barrier predict latency to solve full social problem?

Does latency to approach barrier predict time in social reward?
Do individuals who solve the barrier problem approach the barrier more quickly? (boxplot)
Do individual who solvev the full social problem approach the barrier more quickly? (boxplot)

OTHER FACTORS:
Does sex predict time to solve barrier problem?
Does sex predict time to solve full social problem?
Does sex predict if you solve barrier problem?
Does sex predict if you solve foll social problem?
Does sex predict latency to approach barrier?
Does sex predict proportion time in social reward?

Does size predict time to solve barrier problem?
Does size predict time to solve full social problem?
Does size predict if you solve barrier problem?
Does size predict if you solve foll social problem?
Does size predict latency to approach barrier?
Does size predict proportion time in social reward?

Does order predict time to solve barrier problem?
Does order predict time to solve full social problem?
Does order predict if you solve barrier problem?
Does order predict if you solve foll social problem?
Does order predict latency to approach barrier?
Does order predict proportion time in social reward?










