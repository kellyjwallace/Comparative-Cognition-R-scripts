---
title: "Comparative Cognition Additional Data ANalysis 2019"
author: "Kelly Wallace"
date: "February 19, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(rmarkdown)
library(knitr)
library(readr)
library(utils)
library(EnvStats)
library(gridExtra)
library(cowplot)
library(grid)
library(waffle)
library(extrafont)
library(ggfortify)
library(cluster)
library(tidyr)
library(MASS)
library(scales)
library(candisc)
#font_import()

shuttle<-read.csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Shuttlebox/Comparative Cognition Shuttlebox Data december 20 2018 30 seconds.csv")

det<-read.csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Detour/detour_data_for_R_April_5_2018.csv")

num<-read.csv("C:/Users/Kelly/Desktop/Grad School/Cummings Lab/Comparative Cognition/Comparative Cognition R Scripts/Numerosity Comparative Cognition Full Dataset July_20_2018.csv")

df.full<- left_join(det,shuttle, by = 'fish_name')
df.full<- left_join(df.full,num, by = 'fish_name')
df.full$detour_trial_1_did_fish_solve_barrier_problem <-as.character(df.full$detour_trial_1_did_fish_solve_barrier_problem)
df.full$did_fish_have_a_median_above_60 <-as.character(df.full$did_fish_have_a_median_above_60)
rsquaredtxt <- (expression(r^2))
chisquaredtxt <- (expression(X^2))


df.full.females<- df.full %>% filter(sex.x == "F")
df.full.males<- df.full %>% filter(sex.x == "M")


#removing unnecessary columns from the dataset:
drops <- c("sex.y","detour_trial_1_date_of_trial","detour_trial_1_time_of_trial","detour_trial_1_did_fish_solve_full_social_problem","detour_trial_1_full_problem_time_to_social_reward_minus_time_to_contact_barrier","detour_trial_1_time_from_barrier_contact_minus_time_to_end_of_alley","scorer","shuttlebox_start_side","presentation_when_fish_gave_up3","shuttlebox_average_proportion_of_time_on_correct_side_during_gaps","prop_within_10cm_during_stims_4_through_9","prop_within_10cm_during_all_stims","difference_avg_prop_correct_first_3_gaps_minus_last_3_gaps","difference_avg_prop_correct_first_three_gaps_minus_gap_6","difference_avg_prop_correct_first_three_gaps_minus_avg_gaps_456", "speed_of_learning_aka_which_presentation_20_percent_prop_increase_was_met","did_fish_meet_60_percent_3_consecutive_criterion","did_fish_meet_90_percent_2_consecutive_criterion", "speed_of_learning_60_percent_3_consecutive_criterion","speed_of_learning_90_percent_2_consecutive_criterion","did_fish_meet_within10cm_50_percent_3_consecutive_criterion","speed_of_learning_within10cm_50_percent_3_consecutive_criterion", "average_proportion_within_10cm_gaps_456", "proportion_time_on_left_third_across_gaps_4_through_9", "proportion_time_on_right_third_across_gaps_4_through_9","proportion_time_on_center_third_across_gaps_4_through_9","proportion_time_on_left_10cm_across_gaps_4_through_9", "proportion_time_on_right_10cm_across_gaps_4_through_9", "proportion_time_on_center_10cm_across_gaps_4_through_9", "proportion_time_on_left_10cm_across_stims_1_through_6","did_fish_solve_shuttlebox_using_prop_correct_increase_of_at_least_20_percent_first_3_vs_last_3", "did_fish_solve_shuttlebox_using_prop_correct_increase_of_at_least_20_percent_first_3_vs_456", "did_fish_solve_shuttlebox_using_prop_correct_increase_of_at_least_20_percent_first_3_vs_6", "did_fish_participate_criterion1", "did_fish_participate_criterion2", "did_fish_participate_criterion3","did_fish_participate_criterion4","did_fish_participate_criterion5", "did_fish_participate_criterion6","rank_speed_of_learning", "average_prop_time_thigmo_T0_to_T29", "average_prop_time_mirror_T0_to_T29", "average_number_of_entries_T0_to_T29", "average_number_of_entries_T30_to_T50","average_latency_enter_either_screen","average_performance_across_all_9_testing_trials_using_full_4_minutes_data","total_number_of_testing_trials_using_full_4_minutes_data", "total_number_of_testing_trials_using_T30_to_T50_data", "number_of_trials_on_0.50_ratio_using_full_4_minutes_data", "number_of_trials_on_0.67_ratio_using_full_4_minutes_data", "number_of_trials_on_0.75_ratio_using_full_4_minutes_data","number_of_trials_on_0.50_ratio_using_T30_to_T50_data", "number_of_trials_on_0.67_ratio_using_T30_to_T50_data", "number_of_trials_on_0.75_ratio_using_T30_to_T50_data", "median_performance_on_0.50_ratio_using_full_4_minutes_data", "median_performance_on_0.67_ratio_using_full_4_minutes_data","median_performance_on_0.75_ratio_using_full_4_minutes_data", "median_performance_on_0.50_ratio_using_T30_to_T50_data", "median_performance_on_0.67_ratio_using_T30_to_T50_data", "median_performance_on_0.75_ratio_using_T30_to_T50_data","number_of_medians_above_60_using_full_4_minutes_data", "number_of_medians_above_60_using_T30_to_T50_data", "number_of_medians_above_60_using_T30_to_T50_data_two_and_three_combined", "shapiro_wilk_test_p_value_using_full_4_minutes_data", "was_average_performance_significantly_different_from_0.5_full_4_minutes_p_value_of_either_t_test_or_wilcox", "shapiro_wilk_test_p_value_using_T30_to_T50_data", "was_average_performance_significantly_different_from_0.5_T30_to_T50_p_value_of_either_t_test_or_wilcox", "learning_category_according_to_etheredge_T30_to_T50", "learning_category_according_to_etheredge_full_4_minutes","average_latency_to_enter_incorrect_side", "average_latency_to_enter_correct_side_filtered_just_correct_choice",
"number_of_trials_in_a_row_greater_than_60_percent_full_4_minutes","number_of_trials_in_a_row_greater_than_60_percent_T30_to_T50", "number_of_trials_in_a_row_correct_choice_first", "mean_of_median_performance_on_each_ratio_full_four_minutes_data", "mean_of_median_performance_on_each_ratio_T30_to_T50_data")
           
df<-df.full[ , !(names(df.full) %in% drops)]

df<-unite(df, numsolvesex, c(sex.x, did_fish_have_a_median_above_60), remove=FALSE)

df.num <-df %>% filter(is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data) == FALSE)
df.num<-df.num %>% filter(is.na(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)
df.num$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.num$detour_trial_1_did_fish_solve_barrier_problem)
df.num$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<-as.numeric(df.num$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)


```

#boxplots of exploration, activity, reaction time by learners vs nonlearners in SHUTTLEBOX

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df<- df %>% filter(is.na(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)

test<-t.test(df$unique_zones_entered_full_4_minutes ~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$unique_zones_entered_full_4_minutes~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=0.4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict exploration in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df.females<- df.females %>% filter(is.na(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)


test<-t.test(df.females$unique_zones_entered_full_4_minutes ~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$unique_zones_entered_full_4_minutes~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=0.4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict exploration in numerosity- FEM")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df<- df %>% filter(is.na(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)

test<-t.test(df$average_number_of_entries_full_4_minutes ~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$average_number_of_entries_full_4_minutes~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=100, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict activity in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df.females<- df.females %>% filter(is.na(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)


test<-t.test(df.females$average_number_of_entries_full_4_minutes ~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$average_number_of_entries_full_4_minutes~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=100, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict activity in numerosity- FEM")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df<- df %>% filter(is.na(df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)

test<-t.test(df$average_reaction_time ~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$average_reaction_time~ df$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=average_reaction_time)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=30, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict reaction time in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.character(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df.females<- df.females %>% filter(is.na(df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) == FALSE)


test<-t.test(df.females$average_reaction_time ~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$average_reaction_time~ df.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=average_reaction_time)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=30, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning shuttlebox predict reaction time in numerosity- FEM")



```


#NOW BY DETOUR



#boxplots of exploration, activity, reaction time by learners vs nonlearners in detour

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df$detour_trial_1_did_fish_solve_barrier_problem)

df<- df %>% filter(is.na(df$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)

test<-t.test(df$unique_zones_entered_full_4_minutes ~ df$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$unique_zones_entered_full_4_minutes~ df$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=0.4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict exploration in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.females$detour_trial_1_did_fish_solve_barrier_problem)

df.females<- df.females %>% filter(is.na(df.females$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.females$unique_zones_entered_full_4_minutes ~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$unique_zones_entered_full_4_minutes~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=0.4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict exploration in numerosity- FEM")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.males <- df %>% filter(sex.x == "F")

df.males$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.males$detour_trial_1_did_fish_solve_barrier_problem)

df.males<- df.males %>% filter(is.na(df.males$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.males$unique_zones_entered_full_4_minutes ~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.males$unique_zones_entered_full_4_minutes~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=unique_zones_entered_full_4_minutes)) + 
  geom_boxplot(color = "blue")+ stat_n_text() +
  geom_text(x=1,y=0.4, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict exploration in numerosity- MALES")

```





```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df$detour_trial_1_did_fish_solve_barrier_problem)

df<- df %>% filter(is.na(df$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)

test<-t.test(df$average_number_of_entries_full_4_minutes ~ df$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$average_number_of_entries_full_4_minutes~ df$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=100, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict activity in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.females$detour_trial_1_did_fish_solve_barrier_problem)

df.females<- df.females %>% filter(is.na(df.females$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.females$average_number_of_entries_full_4_minutes ~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$average_number_of_entries_full_4_minutes~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=100, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict activity in numerosity- FEM")



```



```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.males <- df %>% filter(sex.x == "F")

df.males$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.males$detour_trial_1_did_fish_solve_barrier_problem)

df.males<- df.males %>% filter(is.na(df.males$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.males$average_number_of_entries_full_4_minutes ~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.males$average_number_of_entries_full_4_minutes~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_number_of_entries_full_4_minutes)) + 
  geom_boxplot(color = "blue")+ stat_n_text() +
  geom_text(x=1,y=100, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict activity in numerosity- MALES")

```





```{r, echo=FALSE, message=FALSE, warning=FALSE}
df$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df$detour_trial_1_did_fish_solve_barrier_problem)

df<- df %>% filter(is.na(df$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)

test<-t.test(df$average_reaction_time ~ df$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df$average_reaction_time~ df$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot()+ stat_n_text() +
  geom_text(x=1,y=30, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict reaction time in numerosity- sexes combined?")



```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.females <- df %>% filter(sex.x == "F")

df.females$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.females$detour_trial_1_did_fish_solve_barrier_problem)

df.females<- df.females %>% filter(is.na(df.females$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.females$average_reaction_time ~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.females$average_reaction_time~ df.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot(aes(color = "red"))+ stat_n_text() +
  geom_text(x=1,y=30, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict reaction time in numerosity- FEM")



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.males <- df %>% filter(sex.x == "F")

df.males$detour_trial_1_did_fish_solve_barrier_problem<- as.character(df.males$detour_trial_1_did_fish_solve_barrier_problem)

df.males<- df.males %>% filter(is.na(df.males$detour_trial_1_did_fish_solve_barrier_problem) == FALSE)


test<-t.test(df.males$average_reaction_time ~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.males$average_reaction_time~ df.males$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.males, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_reaction_time)) + 
  geom_boxplot(color = "blue")+ stat_n_text() +
  geom_text(x=1,y=30, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("Does learning detour predict reaction time in numerosity- MALES")

```








#[13] "average_number_of_entries_full_4_minutes"                                        
#[14] "average_reaction_time"                                                           
#[15] "totalthigmo_full_4_minutes"                                                      
#[16] "totalmirror_full_4_minutes"                                                      
#[17] "unique_zones_entered_full_4_minutes"                                             
#[18] "entries_into_center_full_4_minutes"                                              
#[19] "average_prop_time_center_full_4_minutes"





```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior PCA
df.num.pca <- prcomp(df.num[,c(13,14,15,16,17,18,19)], center = TRUE,scale. = TRUE)
summary(df.num.pca)
str(df.num.pca)

autoplot(df.num.pca, data = df.num, colour = 'sex.x', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)


#with elipses
autoplot(df.num.pca, data = df.num, colour = 'sex.x', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')


```




```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior PCA
df.num.pca <- prcomp(df.num[,c(13,14,15,16,17,18,19)], center = TRUE,scale. = TRUE)
summary(df.num.pca)
str(df.num.pca)

autoplot(df.num.pca, data = df.num, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

autoplot(df.num.pca, data = df.num, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior PCA
df.num.pca <- prcomp(df.num[,c(13,14,15,16,17,18,19)], center = TRUE,scale. = TRUE)
summary(df.num.pca)
str(df.num.pca)


autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

#with confidence ellipses
autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')

```

#USES ONLY THE THREE BEHAVIORS FROM FEMALE COGNITIVE STYLE MEASUREMENTS

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior PCA
df.num.pca <- prcomp(df.num[,c(13,14,15,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.pca)
str(df.num.pca)


autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

#with confidence ellipses
autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')

```
```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.num.females<-df.num %>% filter(sex.x == "F")

#behavior PCA
df.num.fem.pca <- prcomp(df.num.females[,c(13,14,15,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.fem.pca)
str(df.num.fem.pca)


autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

#with confidence ellipses
autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')


df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive <-as.character(df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')



df.num.females$detour_trial_1_did_fish_solve_barrier_problem <-as.character(df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
autoplot(df.num.fem.pca, data = df.num.females, colour = 'detour_trial_1_did_fish_solve_barrier_problem', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')


```



#now using four behaviors: explration, activity, reaction time, and anxiety

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior PCA
df.num.pca <- prcomp(df.num[,c(13,14,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.pca)
str(df.num.pca)


autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

#with confidence ellipses
autoplot(df.num.pca, data = df.num, colour = 'numsolvesex', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.num.females<-df.num %>% filter(sex.x == "F")

#behavior PCA
df.num.fem.pca <- prcomp(df.num.females[,c(13,14,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.fem.pca)
str(df.num.fem.pca)


autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE)

#with confidence ellipses
autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_have_a_median_above_60', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')

autoplot(df.num.fem.pca, data = df.num.females, colour = 'fish_name', size = 5,loadings = TRUE, label = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')


df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive <-as.character(df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
autoplot(df.num.fem.pca, data = df.num.females, colour = 'did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')



df.num.females$detour_trial_1_did_fish_solve_barrier_problem <-as.character(df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
autoplot(df.num.fem.pca, data = df.num.females, colour = 'detour_trial_1_did_fish_solve_barrier_problem', size = 5, loadings = TRUE, loadings.colour = 'black',loadings.label = TRUE, frame = TRUE, frame.type = 'norm')




```




#ok here's where I'll add six boxplots:
do female NUMEROSITY learners vs nonlearners differ in their PCA1 axis (option 1- using the three behaviors)
do female NUMEROSITY learners vs nonlearners differ in their PCA1 axis (option 2- using the four behaviors)

```{r, echo=FALSE, message=FALSE, warning=FALSE}

df.num.females<-df.num %>% filter(sex.x == "F")


df.num.fem.pca3 <- prcomp(df.num.females[,c(13,14,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.fem.pca3)
str(df.num.fem.pca3)

fempcabehav3<- as.data.frame(df.num.fem.pca3$x)

df.num.fem.pca4 <- prcomp(df.num.females[,c(13,14,15,17)], center = TRUE,scale. = TRUE) #just the three behaviors exploration, activity, reaction time
summary(df.num.fem.pca4)
str(df.num.fem.pca4)

fempcabehav4<- as.data.frame(df.num.fem.pca4$x)

df.num.females<-df.num.females %>% mutate(PC1behaviors3 = fempcabehav3$PC1)
df.num.females<-df.num.females %>% mutate(PC1behaviors4 = fempcabehav4$PC1)



test<-t.test(df.num.females$PC1behaviors3 ~ df.num.females$did_fish_have_a_median_above_60)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors3~ df.num.females$did_fish_have_a_median_above_60)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.num.females, aes(x=did_fish_have_a_median_above_60, y=PC1behaviors3)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("female numerosity learners vs nonlearners
              on PC1 score (three behaviors) (look at T-test)")




test<-t.test(df.num.females$PC1behaviors4 ~ df.num.females$did_fish_have_a_median_above_60)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors4~ df.num.females$did_fish_have_a_median_above_60)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value


p <- ggplot(df.num.females, aes(x=did_fish_have_a_median_above_60, y=PC1behaviors4)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}, 
                                          p(wilcox) = {round(p_value_wilcox,4)}"), size = 6, color = "black")
p +  ggtitle ("female numerosity learners vs nonlearners
              on PC1 score (four behaviors) (look at T-test)")



#NOW ON TO DETOUR PERFORMANCE

df.num.females$detour_trial_1_did_fish_solve_barrier_problem<-as.character(df.num.females$detour_trial_1_did_fish_solve_barrier_problem)

test<-t.test(df.num.females$PC1behaviors3 ~ df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors3~ df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.num.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=PC1behaviors3)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}}"), size = 6, color = "black")
p +  ggtitle ("female detour learners vs nonlearners
              on PC1 score (three behaviors)")




test<-t.test(df.num.females$PC1behaviors4 ~ df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors4~ df.num.females$detour_trial_1_did_fish_solve_barrier_problem)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value


p <- ggplot(df.num.females, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=PC1behaviors4)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}}"), size = 6, color = "black")
p +  ggtitle ("female detour learners vs nonlearners
              on PC1 score (four behaviors) (look at T-test)")





#NOW ONTO SHUTTLEBOX PERFORMANCE



df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<-as.character(df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

test<-t.test(df.num.females$PC1behaviors3 ~ df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors3~ df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value

p <- ggplot(df.num.females, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=PC1behaviors3)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}}"), size = 6, color = "black")
p +  ggtitle ("female shuttlebox learners vs nonlearners
              on PC1 score (three behaviors)")




test<-t.test(df.num.females$PC1behaviors4 ~ df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
p_value_t<- test$p.value
wilcox_test<-wilcox.test(df.num.females$PC1behaviors4~ df.num.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
wilcox_test$estimate
p_value_wilcox<-wilcox_test$p.value


p <- ggplot(df.num.females, aes(x=did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, y=PC1behaviors4)) + 
  geom_boxplot(color = "red")+ stat_n_text() +
  geom_text(x=1,y=-1, label= glue::glue("p (t-test)= {round(p_value_t,4)}}"), size = 6, color = "black")
p +  ggtitle ("female shuttlebox learners vs nonlearners
              on PC1 score (four behaviors) (look at T-test)")



```


do female DETOUR learners vs nonlearners differ in their PCA1 axis (option 1- using the three behaviors)
do female DETOUR learners vs nonlearners differ in their PCA1 axis (option 2- using the four behaviors)

do female SHUTTLEBOX learners vs nonlearners differ in their PCA1 axis (option 1- using the three behaviors)
do female SHUTTLEBOX learners vs nonlearners differ in their PCA1 axis (option 2- using the four behaviors)









#Discriminant Function Analysis

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior DFA
lda <- lda(numsolvesex ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1,1,1)/4)
lda$prior
lda$counts
lda$means
lda$scaling
lda$svd
prop.lda = lda$svd^2/sum(lda$svd^2)


lda <- lda(numsolvesex ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1,1,1)/4, CV = TRUE)

lda$class
lda$posterior #tells you for each individual (row) their probabilty of being a certain sex, based on the behavioral data (I think?)

x<-lm(cbind(average_number_of_entries_full_4_minutes, average_reaction_time, totalthigmo_full_4_minutes, totalmirror_full_4_minutes, unique_zones_entered_full_4_minutes,  entries_into_center_full_4_minutes, average_prop_time_center_full_4_minutes)~numsolvesex, df.num)

out2 <-candisc(x, term="numsolvesex")
plot(out2)
can1 <- out2$scores[2]
can2 <- out2$scores[3]

  
df2 <- subset(df.num, select=c("average_number_of_entries_full_4_minutes","average_reaction_time", "totalthigmo_full_4_minutes","totalmirror_full_4_minutes","unique_zones_entered_full_4_minutes","entries_into_center_full_4_minutes", "average_prop_time_center_full_4_minutes"))

for(i in 1:ncol(df2))
{
  shapiro<-shapiro.test(df2[i][,1]) #if significant, then use spearman not pearson
  print(shapiro)
  plot(can1[,1],df2[i][,1])
  abline(lm(df2[i][,1]~Can1[,1]))
  print(colnames(df2[i]))
  print(cor.test(df2[i][,1],can1[,1], method = "pearson"))
  print(cor.test(df2[i][,1],can1[,1], method = "spearman"))
}


for(i in 1:ncol(df2))
{
  shapiro.test(df2[i][,1]) #if significant, then use spearman not pearson
  plot(Can2[,1],df2[i][,1])
  abline(lm(df2[i][,1]~can2[,1]))
  print(colnames(df2[i]))
  print(cor.test(df2[i][,1],can2[,1], method = "pearson"))
  print(cor.test(df2[i][,1],can2[,1], method = "spearman"))
  shapiro.test(df2[i][,1]) #if significant, then use spearman not pearson
}







#use this code to make the plot

lda <- lda(numsolvesex ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1,1,1)/4)
prop.lda = lda$svd^2/sum(lda$svd^2)

plda <- predict(object = lda, newdata = df.num)
pca <- prcomp(df.num[,c(13,14,15,16,17,18,19)], center = TRUE,scale. = TRUE)

dataset = data.frame(numsolvesex = df.num[,"numsolvesex"],pca = pca$x, lda = plda$x)

plot(lda)

p1 <- ggplot(dataset) +
  geom_point(aes(lda.LD1, lda.LD2, colour = numsolvesex), size = 2.5) + 
  labs(x = paste("LD1 (", percent(prop.lda[1]), ")", sep=""), y = paste("LD2 (", percent(prop.lda[2]), ")", sep=""))
p1

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
#behavior DFA
lda <- lda(sex.x ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1)/2)
lda$prior
lda$counts
lda$means
lda$scaling
lda$svd
prop.lda = lda$svd^2/sum(lda$svd^2)


lda <- lda(sex.x ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1)/2, CV = TRUE)

lda$class
lda$posterior #tells you for each individual (row) their probabilty of being a certain sex, based on the behavioral data (I think?)



#use this code to make the plot

lda <- lda(sex.x ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1)/2)
prop.lda = lda$svd^2/sum(lda$svd^2)

plda <- predict(object = lda, newdata = df.num)

dataset = data.frame(sex.x = df.num[,"sex.x"],pca = pca$x, lda = plda$x)

plot(lda)

#Can't seem to visualize the LDA because my variation is 100% explained by the LD1 (the one axis), also how do i figure out what LD1 is?
```







```{r, echo=FALSE, message=FALSE, warning=FALSE}
#NOW CHAD'S CODE WITH GOUPRS = NUMSOLVESEX
lda <- lda(numsolvesex ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1,1,1)/4)
pred.res <- predict(lda)
DFAscores <- pred.res$x
dfa.table <- table(df.num[,2], pred.res$class) # 2 means column numsolvesex
diag(prop.table(dfa.table, 1))

# total percent correct
sum(diag(prop.table(dfa.table)))

#ANOVA on DFA axes

summary(aov(DFAscores[,1] ~factor(df.num[,2]))) #p = 0.00028 this is an ANOVA on the DFAscores with the factor being the four categories (male numerosity learner, male nonlearner, female learner, female nonlearner)

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
#NOW AGAIN CHAD'S CODE BUT WITH SEX
lda <- lda(sex.x ~ average_number_of_entries_full_4_minutes + average_reaction_time + totalthigmo_full_4_minutes + totalmirror_full_4_minutes + unique_zones_entered_full_4_minutes + entries_into_center_full_4_minutes + average_prop_time_center_full_4_minutes, data = df.num, prior = c(1,1)/2)
pred.res <- predict(lda)
DFAscores <- pred.res$x
dfa.table <- table(df.num[,3], pred.res$class) # 3 means column sex.x
diag(prop.table(dfa.table, 1))

# total percent correct
sum(diag(prop.table(dfa.table)))

#ANOVA on DFA axes

summary(aov(DFAscores[,1] ~factor(df.num[,3]))) #p = 0.000486



```


#MANOVA
```{r, echo=FALSE, message=FALSE, warning=FALSE}

# MANOVA test
res.shutxnum <- manova(cbind(average_performance_across_all_9_testing_trials_using_T30_to_T50_data,did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) ~ sex.x, data = df.num)

res.detxshut<- manova(cbind(detour_trial_1_did_fish_solve_barrier_problem,did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) ~ sex.x, data = df.num)

res.detxnum<-manova(cbind(detour_trial_1_did_fish_solve_barrier_problem,average_performance_across_all_9_testing_trials_using_T30_to_T50_data) ~ sex.x, data = df.num)

res.allthree<- manova(cbind(detour_trial_1_did_fish_solve_barrier_problem,average_performance_across_all_9_testing_trials_using_T30_to_T50_data, did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive) ~ sex.x, data = df.num) 


summary(res.shutxnum) #*****significant! 0.02616 *
summary(res.detxshut) #0.1082
summary(res.detxnum) #0.2804
summary(res.allthree) #0.0669



#If the global multivariate test is significant, we conclude that the corresponding effect (treatment) is significant. In that case, the next question is to determine if the treatment affects only the weight, only the height or both. In other words, we want to identify the specific dependent variables that contributed to the significant global effect.
```


#THIS IS THE NEW "FINAL FIGURES" SCRIPT PORTION

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.num$detour_trial_1_did_fish_solve_barrier_problem<-as.character(df.num$detour_trial_1_did_fish_solve_barrier_problem)


plot1 <- ggplot(df.num, aes(x=detour_trial_1_did_fish_solve_barrier_problem, y=average_performance_across_all_9_testing_trials_using_T30_to_T50_data, color = sex.x)) + 
  geom_boxplot(lwd=1)+ 
  labs(x= "Detour Solve Category",y="Numerosity Performance") + theme(axis.text.y = element_text(size = 14)) + theme(axis.text.x = element_text(size = 14)) +
  theme(legend.position="top") +
  scale_color_manual(values=c("maroon", "lightblue")) +
  scale_fill_manual(name="Sex",labels=c("Female", "Male")) +
  geom_point(position = position_jitterdodge(jitter.width = 0.1))
plot1


```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.full.males$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.full.males$detour_trial_1_did_fish_solve_barrier_problem)
df.full.females$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.full.females$detour_trial_1_did_fish_solve_barrier_problem)

#to get the numbers I ran this code:
w<-nrow(df.full.males%>%filter(detour_trial_1_did_fish_solve_barrier_problem == 1))
x<-nrow(df.full.females%>%filter(detour_trial_1_did_fish_solve_barrier_problem == 1))
y<-nrow(df.full.males%>%filter(detour_trial_1_did_fish_solve_barrier_problem == 0))
z<-nrow(df.full.females%>%filter(detour_trial_1_did_fish_solve_barrier_problem == 0))

solvers = c(w,x)
nonsolvers = c(y,z)
detsolvesex<-data.frame(solvers,nonsolvers)
chi<-chisq.test(detsolvesex)
chip<-chi$p.value

#This is Fisher's exact Test, an alternative that can hendle small numbers in each cell (i.e. when we have only one male learner)



#female solvers = w
#male solvers = x
#female nonsolvers = y
#male nonsolvers = z

df.full$detour_trial_1_did_fish_solve_barrier_problem<-as.numeric(df.full$detour_trial_1_did_fish_solve_barrier_problem)

ggplot(df.full, aes(detour_trial_1_did_fish_solve_barrier_problem, fill = sex.x))+
  geom_histogram(binwidth = 0.5) + 
  labs(x= "Detour Learning Category",y="Number of individuals") +  
  scale_x_discrete(breaks=c(0, 1)) +
  annotate("text", x=-0.48, y=28, label= glue::glue("nonsolvers"), size = 7, color = "black", hjust = 0) +
  annotate("text", x=0.75, y=30, label= glue::glue("solvers"), size = 7, color = "black", hjust = 0) +
  theme(plot.title = element_text(hjust = 0)) +
  annotate("text", x=-0.1, y=14, label= glue::glue(z), size = 7, color = "white", hjust = 0)+
  annotate("text", x=-0.1, y=2, label= glue::glue(y), size = 7, color = "white", hjust = 0) +
  annotate("text", x=0.88, y=15, label= glue::glue(x), size = 7, color = "white", hjust = 0)+
  annotate("text", x=0.88, y=2, label= glue::glue(w), size = 7, color = "white", hjust = 0) +
  scale_color_manual(values=c("maroon", "lightblue")) +
  theme(legend.position="left") + 
  #guides(fill=guide_legend(title= "Sex")) +
  scale_fill_manual(values=c("maroon", "lightblue"),name="Sex",labels=c("  female", "  male")) #+ 
 # annotate("text",x = -1, y = 4, parse = TRUE, label= glue::glue("{as.character(chisquaredtxt)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -0.7, y = 3.86, parse = TRUE, label= glue::glue("{round(chip,3)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -2, y = -1, parse = TRUE, label= glue::glue("Fisher_exact_test_p_{round(fishp,3)}"), size = 7, color = "black", hjust = 0)


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.full.males$did_fish_have_a_median_above_60<-as.numeric(df.full.males$did_fish_have_a_median_above_60)
df.full.females$did_fish_have_a_median_above_60<-as.numeric(df.full.females$did_fish_have_a_median_above_60)

#to get the numbers I ran this code:
w<-nrow(df.full.males%>%filter(did_fish_have_a_median_above_60 == 1))
x<-nrow(df.full.females%>%filter(did_fish_have_a_median_above_60 == 1))
y<-nrow(df.full.males%>%filter(did_fish_have_a_median_above_60 == 0))
z<-nrow(df.full.females%>%filter(did_fish_have_a_median_above_60 == 0))

solvers = c(w,x)
nonsolvers = c(y,z)
numsolvesex<-data.frame(solvers,nonsolvers)
chi<-chisq.test(numsolvesex)
chip<-chi$p.value

#This is Fisher's exact Test, an alternative that can hendle small numbers in each cell (i.e. when we have only one male learner)



#female solvers = w
#male solvers = x
#female nonsolvers = y
#male nonsolvers = z

df.full$did_fish_have_a_median_above_60<-as.numeric(df.full$did_fish_have_a_median_above_60)

ggplot(df.full, aes(did_fish_have_a_median_above_60, fill = sex.x))+
  geom_histogram(binwidth = 0.5) + 
  labs(x= "Numerosity Learning Category",y="Number of individuals") +  
  scale_x_discrete(breaks=c(0, 1)) +
  annotate("text", x=-0.48, y=16, label= glue::glue("non-learners"), size = 7, color = "black", hjust = 0) +
  annotate("text", x=0.71, y=26, label= glue::glue("learners"), size = 7, color = "black", hjust = 0) +
  theme(plot.title = element_text(hjust = 0)) +
  annotate("text", x=-0.06, y=9, label= glue::glue(z), size = 7, color = "white", hjust = 0)+
  annotate("text", x=-0.06, y=2, label= glue::glue(y), size = 7, color = "white", hjust = 0) +
  annotate("text", x=0.88, y=13, label= glue::glue(x), size = 7, color = "white", hjust = 0)+
  annotate("text", x=0.88, y=2, label= glue::glue(w), size = 7, color = "white", hjust = 0) +
  scale_color_manual(values=c("maroon", "lightblue")) +
  theme(legend.position="left") + 
  #guides(fill=guide_legend(title= "Sex")) +
  scale_fill_manual(values=c("maroon", "lightblue"),name="Sex",labels=c("  Female", "  Male")) #+ 
 # annotate("text",x = -1, y = 4, parse = TRUE, label= glue::glue("{as.character(chisquaredtxt)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -0.7, y = 3.86, parse = TRUE, label= glue::glue("{round(chip,3)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -2, y = -1, parse = TRUE, label= glue::glue("Fisher_exact_test_p_{round(fishp,3)}"), size = 7, color = "black", hjust = 0)


```







```{r, echo=FALSE, message=FALSE, warning=FALSE}
df.full.males$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.numeric(df.full.males$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)
df.full.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<- as.numeric(df.full.females$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

df.full.males$did_fish_participate_criterion7<-as.numeric(df.full.males$did_fish_participate_criterion7)
df.full.females$did_fish_participate_criterion7<-as.numeric(df.full.females$did_fish_participate_criterion7)

#to get the numbers I ran this code:
w.df<-df.full.males%>%filter(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive == 1) %>% filter(did_fish_participate_criterion7 == 1) %>% filter(presentation_when_fish_gave_up4 >3)
w<- nrow(w.df)
x.df<-df.full.females%>%filter(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive == 1)  %>% filter(did_fish_participate_criterion7 == 1) %>% filter(presentation_when_fish_gave_up4 >3)
x<- nrow(x.df)
y.df<-df.full.males%>%filter(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive == 0)%>% filter(did_fish_participate_criterion7 == 1) %>% filter(presentation_when_fish_gave_up4 >3)
y<- nrow(y.df)
z.df<-df.full.females%>%filter(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive == 0) %>% filter(did_fish_participate_criterion7 == 1) %>% filter(presentation_when_fish_gave_up4 >3)
z<- nrow(z.df)

solvers = c(w,x)
nonsolvers = c(y,z)
shuttleboxsolvesex<-data.frame(solvers,nonsolvers)
chi<-chisq.test(shuttleboxsolvesex)
chip<-chi$p.value

#This is Fisher's exact Test, an alternative that can hendle small numbers in each cell (i.e. when we have only one male learner)
fish<-fisher.test(shuttleboxsolvesex)
fishp<-fish$p.value

df.shuttle<-df.full  %>% filter(did_fish_participate_criterion7 == 1) %>% filter(presentation_when_fish_gave_up4 >3)


df.shuttle$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive<-as.numeric(df.shuttle$did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive)

ggplot(df.shuttle, aes(did_fish_learn_OF_SCREEN_TIME_50_percent_within_10_cm_3_consecutive, fill = sex.x))+
  geom_histogram(binwidth = 0.5) + 
  labs(x= "Shuttlebox Learning Category",y="Number of individuals") +  
  scale_x_discrete(breaks=c(0, 1)) +
  annotate("text", x=-0.48, y=21, label= glue::glue("non-learners"), size = 7, color = "black", hjust = 0) +
  annotate("text", x=0.71, y=10, label= glue::glue("learners"), size = 7, color = "black", hjust = 0) +
  theme(plot.title = element_text(hjust = 0)) +
  annotate("text", x=-0.09, y=11, label= glue::glue(z), size = 7, color = "white", hjust = 0)+
  annotate("text", x=-0.06, y=1.5, label= glue::glue(y), size = 7, color = "white", hjust = 0) +
  annotate("text", x=0.96, y=1.5, label= glue::glue(x), size = 7, color = "white", hjust = 0)+
  scale_color_manual(values=c("maroon", "lightblue")) +
  theme(legend.position="left") + 
  #guides(fill=guide_legend(title= "Sex")) +
  scale_fill_manual(values=c("maroon", "lightblue"),name="Sex",labels=c("  Female", "  Male")) #+ 
 # annotate("text",x = -1, y = 4, parse = TRUE, label= glue::glue("{as.character(chisquaredtxt)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -0.7, y = 3.86, parse = TRUE, label= glue::glue("{round(chip,3)}"), size = 7, color = "black", hjust = 0) +
 # annotate("text",x = -2, y = -1, parse = TRUE, label= glue::glue("Fisher_exact_test_p_{round(fishp,3)}"), size = 7, color = "black", hjust = 0)


```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<- lm(df.full.males$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.males$average_number_of_entries_full_4_minutes, na.rm = TRUE)


number <- df.full.males %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_number_of_entries_full_4_minutes)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot1 <- ggplot(df.full.males, aes(average_number_of_entries_full_4_minutes, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + geom_point(size = 4, color = "lightblue") + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "activity",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "lightgray", se = FALSE) +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  theme(plot.title = element_text(hjust = 0)) +
  scale_x_discrete(name ="activity",breaks=c("30","60","90","120"))
plot1

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}


mod<- lm(df.full.males$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.males$average_reaction_time, na.rm = TRUE)
summary(mod)

number <- df.full.males %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_reaction_time)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot2 <- ggplot(df.full.males, aes(average_reaction_time, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) +
  geom_point(size = 4, color = "lightblue") + 
  theme(text = element_text(size=10)) + 
#  annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
#  annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
#  annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
# n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "reaction time",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "lightgray", se = FALSE) +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  ggtitle ("males") +
  theme(plot.title = element_text(hjust = 0))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot2

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<- lm(df.full.males$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.males$unique_zones_entered_full_4_minutes, na.rm = TRUE)
summary(mod)

number <- df.full.males %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(unique_zones_entered_full_4_minutes)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot3 <- ggplot(df.full.males, aes(unique_zones_entered_full_4_minutes, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + geom_point(size = 4, color = "lightblue") + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "exploration",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "lightgray", se = FALSE) +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  ggtitle ("males") +
  theme(plot.title = element_text(hjust = 0))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot3



```



```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<- lm(df.full.females$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.females$average_number_of_entries_full_4_minutes, na.rm = TRUE)


number <- df.full.females %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_number_of_entries_full_4_minutes)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot1 <- ggplot(df.full.females, aes(average_number_of_entries_full_4_minutes, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + geom_point(size = 4, color = "maroon") + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "activity",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "black", fill = "lightgray") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot1

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}


mod<- lm(df.full.females$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.females$average_reaction_time, na.rm = TRUE)
summary(mod)

number <- df.full.females %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_reaction_time)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot2 <- ggplot(df.full.females, aes(average_reaction_time, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) +
  geom_point(size = 4, color = "maroon") + 
  theme(text = element_text(size=10)) + 
#  annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
#  annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
#  annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
# n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "reaction time",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "black", fill = "lightgray") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0))+
  xlim(0, 22)
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot2

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<- lm(df.full.females$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full.females$unique_zones_entered_full_4_minutes, na.rm = TRUE)
summary(mod)

number <- df.full.females %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(unique_zones_entered_full_4_minutes)) %>% nrow
p_value <- summary(mod)$coefficients[8]
r_squared <- summary(mod)$r.squared

plot3 <- ggplot(df.full.females, aes(unique_zones_entered_full_4_minutes, average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) + geom_point(size = 4, color = "maroon") + 
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "exploration",y="Numerosity Performance") +
 geom_smooth(method = "lm", size = 2, color = "black", fill = "lightgray") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
  ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0))+
  xlim(0.65, 1)
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot3



```

#SEXES COMBINED, INTERACTION
```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<-lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$average_number_of_entries_full_4_minutes * df.full$sex.x)


number <- df.full%>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_number_of_entries_full_4_minutes)) %>% nrow
p_value_look_at_last_one <- summary(mod)
r_squared <- summary(mod)$r.squared

df.full$sex.x<-as.character(df.full$sex.x)


plot1 <- ggplot(df.full, aes(x = average_number_of_entries_full_4_minutes, y = average_performance_across_all_9_testing_trials_using_T30_to_T50_data, color = sex.x)) + geom_point(size = 4) + 
  geom_smooth(method = "lm", size = 2, se = FALSE,fullrange=TRUE) +
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "activity",y="Numerosity Performance") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
 # ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0)) + 
  scale_color_manual(values=c("maroon", "lightblue"))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot1

```


```{r, echo=FALSE, message=FALSE, warning=FALSE}


mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$average_reaction_time * df.full$sex.x)
summary(mod)

number <- df.full %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(average_reaction_time)) %>% nrow
p_value_not_really <- summary(mod)
r_squared <- summary(mod)$r.squared

plot2 <- ggplot(df.full, aes(average_reaction_time, average_performance_across_all_9_testing_trials_using_T30_to_T50_data, color = sex.x)) +
  geom_point(size = 4) + 
   geom_smooth(method = "lm", size = 2, se = FALSE,fullrange=TRUE) +
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "reaction time",y="Numerosity Performance") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
 # ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0)) + 
  scale_color_manual(values=c("maroon", "lightblue"))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot2

```



```{r, echo=FALSE, message=FALSE, warning=FALSE}

mod<- lm(df.full$average_performance_across_all_9_testing_trials_using_T30_to_T50_data ~ df.full$unique_zones_entered_full_4_minutes * df.full$sex.x)
summary(mod)

number <- df.full %>% filter(!is.na(average_performance_across_all_9_testing_trials_using_T30_to_T50_data)) %>% filter(!is.na(unique_zones_entered_full_4_minutes)) %>% nrow
p_value_not_really <- summary(mod)
r_squared <- summary(mod)$r.squared

plot3 <- ggplot(df.full, aes(unique_zones_entered_full_4_minutes, average_performance_across_all_9_testing_trials_using_T30_to_T50_data, color = sex.x)) +
  geom_point(size = 4) + 
   geom_smooth(method = "lm", size = 2, se = FALSE,fullrange=TRUE) +
  theme(text = element_text(size=10)) + 
  #annotate("text", x=30, y=0.33, parse = TRUE, label= glue::glue("{as.character(rsquaredtxt)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=32, y=0.32, label= glue::glue("= {round(r_squared,4)}"), size = 5, color = "gray39", hjust = 0) + 
  #annotate("text", x=30, y=0.25, label= glue::glue("p = {round(p_value,4)}
#n = {number}"), size = 5, color = "gray39", hjust = 0) + 
  labs(x= "exploration",y="Numerosity Performance") +
         theme(axis.text=element_text(size=16),
         axis.title=element_text(size=14))+
         theme(axis.line.y = element_line(color="gray", size = 1))+
         theme(axis.line.x = element_line(color="gray", size = 1))+ 
         theme(panel.background = element_blank()) + 
 # ggtitle ("females") +
  theme(plot.title = element_text(hjust = 0)) + 
  scale_color_manual(values=c("maroon", "lightblue"))
  #annotate("text", x=0, y=0.9, label= glue::glue("  (a)"), size = 10, color = "deepskyblue4", hjust = 0) +
  #theme(plot.title = element_text(hjust = 0))
plot3



```




